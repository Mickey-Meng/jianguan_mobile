!function(e){var t=new Cesium.Cartesian3,i=new Cesium.Cartographic,r=SFM.cesiumlib.ZlskEarth,n=r.zlskCesiumUtil,o=function(){return"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".replace(/x/g,(function(e){return(16*Math.random()|0).toString(16)}))},a=function(e,t,i){var r;return e?void 0===(r=e[t])?i:r:i},s=function(e,n,s){var c=e._earth=new r({}),u=$("#"+n);u.css({position:"relative"});var l=o(),d=o(),g=o(),p='<div id="'+l+'" class="sfm-f-viewcontainer"></div><div id="'+d+'" class="sfm-f-earth-mtc" style="position: absolute;top: 0;"></div><div id="'+g+'" class="sfm-m-earth-popupc" style="position: absolute;top: 0;"></div>';u.append(p);var h=$.extend(!0,{navigationHelpButton:!1,infoBox:!1,selectionIndicator:!1,sceneModePicker:!1,baseLayerPicker:!1,animation:!1,shouldAnimate:!0,geocoder:!1,fullscreenButton:!1,homeButton:!1,imageryProvider:{name:"全球底图",url:"./image/imagery/world.jpg",type:"SINGLEIMAGE"}},s.viewerOptions);if(h.imageryProviderViewModels){for(var m=[],f=0,v=h.imageryProviderViewModels.length;f<v;f++){var y=h.imageryProviderViewModels[f],P=r.ZlskCLayerManager.createProviderViewModel(y);P&&m.push(P)}h.imageryProviderViewModels=m}if(h.terrainProviderViewModels){for(m=[],f=0,v=h.terrainProviderViewModels.length;f<v;f++){y=h.terrainProviderViewModels[f];var M=r.ZlskCLayerManager.createProviderViewModel(y);M&&m.push(M)}h.terrainProviderViewModels=m}h.terrainProvider&&(h.terrainProvider=r.ZlskCLayerManager.createTerrainProvider(h.terrainProvider)),h.imageryProvider&&(h.imageryProvider=r.ZlskCLayerManager.createImageryProvider(h.imageryProvider)),c.initViewer(l,h),c.initMouseTip(d),c.initPopup(g);var w=e._viewer=c.getViewer();if(w.cesiumWidget.creditContainer.style.display="none",w.timeline&&(w.timeline.container.hidden=!0),w.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),w.scene.globe.baseColor=Cesium.Color.fromRgba(0),w.scene.globe.depthTestAgainstTerrain=!0,w.scene.globe.backFaceCulling=!1,w.scene.globe.showSkirts=!1,w.scene.screenSpaceCameraController.enableCollisionDetection=!0,w.scene.screenSpaceCameraController.maximumZoomDistance=18021605,w.scene.globe.dynamicAtmosphereLighting=!1,w.scene.light=new Cesium.DirectionalLight({intensity:4,direction:w.scene.camera.directionWC}),w.scene.preRender.addEventListener((function(e,t){e.light.direction=Cesium.Cartesian3.clone(e.camera.directionWC,e.light.direction)})),c.getDefaultLayerManager().addLayerFromConfig(s),s.init||(s.init={}),s.init){var C=a(s.init,"lon",109.72019001173133),x=a(s.init,"lat",37.117993311742744),_=a(s.init,"height",7639047.467307525),k={destination:new Cesium.Cartesian3.fromDegrees(C,x,_),orientation:{heading:Cesium.Math.toRadians(a(s.init,"heading",0)),pitch:Cesium.Math.toRadians(a(s.init,"pitch",-90)),roll:Cesium.Math.toRadians(a(s.init,"roll",0))},duration:a(s.init,"duration",3),maximumHeight:2e3,pitchAdjustHeight:2e3,endTransform:Cesium.Matrix4.IDENTITY};w.camera.flyTo(k),w.homeButton&&w.homeButton.viewModel.command.beforeExecute.addEventListener((function(e){e.cancel=!0,w.scene.camera.flyTo(k)}))}var L=e.data.mouse;w.scene.globe.ellipsoid;new Cesium.ScreenSpaceEventHandler(w.scene.canvas).setInputAction((function(e){var r=w.scene.pickPosition(e.endPosition,t);r?(Cesium.Cartographic.fromCartesian(r,null,i),L.position=r,L.longitude=180*i.longitude/Math.PI,L.latitude=180*i.latitude/Math.PI,L.height=i.height,L.terrainHeight=w.scene.globe.getHeight(i)):(L.position=void 0,L.longitude=void 0,L.latitude=void 0,L.height=void 0,L.terrainHeight=void 0)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)},c=function(e,t){if(e._msg={error:e=>{alert(e)},fail:e=>{alert(e)},warning:e=>{alert(e)},info:e=>{alert(e)},success:e=>{alert(e)},tip:e=>{alert(e)}},t){if("function"==typeof t)for(var i in e._msg)e._msg[i]=t;for(var i in e._msg)"function"==typeof t[i]&&(e._msg[i]=t[i])}},u=function(e){e._dt=g(e)},l=e=>{e._mt=h(e)};const d=e=>r.zlskCEnum.drawType[e];var g=function(e){const t=e._earth.getDefaultDrawTool();return{stop:()=>{t.stopDraw()},clear:()=>{t.clearDraw()},drawPoint:(e,i={toDegree:!0})=>{t.draw(d("POINT"),t=>{"function"==typeof e&&e(t)},i)},drawPolyline:(i,r={toDegree:!0})=>{t.draw(d("POLYLINE"),r=>{const{positions:n}=r;if(!n||n.length<2)return e._msg.warning("最少绘制2个点"),void t.clearLast();"function"==typeof i&&i(r)},r)},drawPolygon:(i,r={toDegree:!0})=>{t.draw(d("POLYGON"),r=>{const{positions:n}=r;if(!n||n.length<3)return e._msg.warning("最少绘制3个点"),void t.clearLast();"function"==typeof i&&i(r)},r)},drawCircle:(e,i={toDegree:!0})=>{t.draw(d("CIRCLE"),e,i)}}};const p=e=>r.zlskCEnum.measureType[e],h=e=>{const t=e._earth.getDefaultMeasureTool();return{stop:()=>{t.stopMeasure()},clear:()=>{t.clear()},measureHDistance:i=>{t.measure(p("HDISTANCE"),r=>{const{positions:n}=r;if(!n||n.length<2)return e._msg.warning("最少绘制2个点"),void t.clearLast();"function"==typeof i&&i(r)})},measureVDistance:i=>{t.measure(p("VDISTANCE"),r=>{const{positions:n}=r;if(!n||n.length<2)return e._msg.warning("最少绘制2个点"),void t.clearLast();"function"==typeof i&&i(r)})},measureSDistance:i=>{t.measure(p("DISTANCE"),r=>{const{positions:n}=r;if(!n||n.length<2)return e._msg.warning("最少绘制2个点"),void t.clearLast();"function"==typeof i&&i(r)})},measureArea:i=>{t.measure(p("AREA"),r=>{const{positions:n}=r;if(!n||n.length<3)return e._msg.warning("最少绘制3个点"),void t.clearLast();"function"==typeof i&&i(r)})},measureHAngle:i=>{t.measure(p("HANGLE"),r=>{const{positions:n}=r;if(!n||n.length<3)return e._msg.warning("最少绘制3个点"),void t.clearLast();"function"==typeof i&&i(r)})},measure:(e,i)=>{t.measure(p(e),i)}}};var m=function(e,t){!function(e,t,i){i||(i={}),e.data={},e.data.mouse={},s(e,t,i),c(e,i.msgHelper),u(e),l(e)}(this,e,t)};Object.defineProperties(m.prototype,{earth:{get:function(){return this._earth}},layers:{get:function(){return this._earth.getDefaultLayerManager()}},viewer:{get:function(){return this._viewer}},drawTool:{get:function(){return this._dt}},measureTool:{get:function(){return this._mt}}}),m.prototype.addLayer=function(e){return this._earth.getDefaultLayerManager().addLayer(e)},m.prototype.getViewPort=function(){return e=this._viewer,{longitude:180*(t=e.camera.positionCartographic).longitude/Math.PI,latitude:180*t.latitude/Math.PI,height:t.height,heading:180*e.camera.heading/Math.PI,pitch:180*e.camera.pitch/Math.PI,roll:180*e.camera.roll/Math.PI};var e,t},m.prototype.flyto=function(e){!function(e,t){var i=Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.height);e.camera.flyTo({destination:i,orientation:n.toHeadingPitchRoll(t),duration:a(t,"duration",3),endTransform:Cesium.Matrix4.IDENTITY})}(this._viewer,e)},m.prototype.getMousePosition=function(){return this.data.mouse},m.prototype.beginPickPosition=function(e){this._earth.beginPickPosition(e)},m.prototype.exitPickPosition=function(){this._earth.exitPickPosition()},m.prototype.beginPick=function(e){return this._earth.beginPick(e)},m.prototype.beginPickInfo=function(e){return this._earth.beginPickInfo(e)},m.prototype.endPick=function(){return this._earth.endPick()},m.prototype.addMarker=function(e){return this._earth.getMarkerManager().add(e)},m.prototype.removeMarker=function(e){this._earth.getMarkerManager().remove(e)},m.prototype.clearMarker=function(){this._earth.getMarkerManager().clear()},m.prototype.showAllMarkers=function(){this._earth.getMarkerManager().show()},m.prototype.hideAllMarkers=function(){this._earth.getMarkerManager().hide()},m.prototype.openPopup=function(e){return this._earth.openPopup(e)},m.prototype.closePopup=function(e,t){this._earth.closePopup(e,t)},m.prototype.clearPopup=function(e){this._earth.clearPopup(e)},e.ZlskEarthHelper=m}(window);