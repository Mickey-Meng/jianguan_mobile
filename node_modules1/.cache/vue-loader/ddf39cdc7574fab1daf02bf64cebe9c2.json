{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\login\\index.vue?vue&type=style&index=0&id=37dfd6fc&lang=scss&scoped=true&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\login\\index.vue","mtime":1684652788153},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1684411443176},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1684411446724},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1684411443221},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1684411446938},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubG9naW4tY29udGFpbmVyIHsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICB0b3A6IDA7DQogIGJvdHRvbTogMDsNCiAgbGVmdDogMDsNCiAgcmlnaHQ6IDA7DQogIGJhY2tncm91bmQ6IHVybCguLi8uLi9hc3NldHMvaW1hZ2UvYmdfbG9naW4ucG5nKSBuby1yZXBlYXQ7DQogIGJhY2tncm91bmQtc2l6ZTogMTAwJSAxMDAlOw0KICAuYmcgew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgLnRpdGxlIHsNCiAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgaGVpZ2h0OiA0NHB4Ow0KICAgICAgZm9udC1zaXplOiAxOXB4Ow0KICAgICAgbWFyZ2luLXRvcDogMjVweDsNCiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgIGZvbnQtZmFtaWx5OiBTRlByby1TZW1pYm9sZCwgU0ZQcm87DQogICAgICBmb250LXdlaWdodDogNjAwOw0KICAgICAgY29sb3I6ICNmZmY7DQogICAgICBsaW5lLWhlaWdodDogNDRweDsNCiAgICB9DQogICAgLmNhcmQgew0KICAgICAgbWFyZ2luOiA4MHB4IDQwcHggMHB4Ow0KICAgICAgb3ZlcmZsb3c6aGlkZGVuOw0KICAgICAgLnRpdGxlIHsNCiAgICAgICAgdGV4dC1hbGlnbjogaW5pdGlhbDsNCiAgICAgICAgaGVpZ2h0OiAzNXB4Ow0KICAgICAgICBtYXJnaW4tdG9wOiAwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMjVweDsNCiAgICAgIH0NCiAgICAgIDo6di1kZWVwIC52YW4tZmllbGQgew0KICAgICAgICBtYXJnaW4tdG9wOiAyMnB4Ow0KICAgICAgICBoZWlnaHQ6IDQ1cHg7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICAgICAgcGFkZGluZzogaW5pdGlhbDsNCiAgICAgICAgcGFkZGluZy1sZWZ0OiAxMHB4Ow0KICAgICAgICAudmFuLWNlbGxfX3ZhbHVlIHsNCiAgICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgICAgLnZhbi1maWVsZF9fYm9keSB7DQogICAgICAgICAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsNCg0KICAgICAgICAgICAgLnZhbi1maWVsZF9fY29udHJvbCB7DQogICAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAudmFuLWZpZWxkX19yaWdodC1pY29uIHsNCiAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAwcHg7DQogICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICAgIC52YW4tc3dpdGNoIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDEyMCwgMTIwLCAxMjgsIDAuMzIpOw0KICAgICAgICAgICAgICAgIHdpZHRoOiAxLjhlbTsNCiAgICAgICAgICAgICAgICBib3JkZXI6IDBweDsNCiAgICAgICAgICAgICAgICAudmFuLXN3aXRjaF9fbm9kZSB7DQogICAgICAgICAgICAgICAgICB0b3A6IDAuMWVtOw0KICAgICAgICAgICAgICAgICAgbGVmdDogMC4xZW07DQogICAgICAgICAgICAgICAgICB3aWR0aDogMC44ZW07DQogICAgICAgICAgICAgICAgICBoZWlnaHQ6IDAuOGVtOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAudmFuLXN3aXRjaC0tb24gew0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxOTg5ZmE7DQogICAgICAgICAgICAgICAgLnZhbi1zd2l0Y2hfX25vZGUgew0KICAgICAgICAgICAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMC44ZW0pOw0KICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDAuOGVtKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIC52YW4tYnV0dG9uIHsNCiAgICAgICAgbWFyZ2luLXRvcDogNDBweDsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA4JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"bg\">\r\n      <div class=\"title\">{{ constantField.wholeName }}</div>\r\n      <div class=\"card\">\r\n        <div class=\"title\">登录</div>\r\n\r\n          <van-field\r\n            v-model=\"loginForm.username\"\r\n            name=\"username\"\r\n            placeholder=\"用户名\"\r\n            :rules=\"[{ required: true, message: '请填写用户名' }]\"\r\n            size=\"large\"\r\n          />\r\n          <van-field\r\n            v-model=\"loginForm.password\"\r\n            :type=\"passwordType\"\r\n            name=\"password\"\r\n            placeholder=\"密码\"\r\n            :rules=\"[{ required: true, message: '请填写密码' }]\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <template slot=\"right-icon\">\r\n              <van-switch v-model=\"showPwd\" @change=\"switchPasswordType\" />\r\n            </template>\r\n          </van-field>\r\n\r\n          <el-button\r\n            type=\"primary\"\r\n            style=\"width: 100%; margin-top: 26px;font-size: 18px; font-weight: 400;\" @click=\"handleLogin\"\r\n            >登录\r\n          </el-button\r\n      >\r\n        </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport constantField from '@/api/home'\r\nimport { login } from '@/api/project.js'\r\nimport { getUserInfo } from '@/api/userauth.js'\r\nimport { appUpdate } from '@/utils/appUpdate.js'\r\nimport { overviewGroups } from '@/config'\r\nexport default {\r\n  data() {\r\n    return {\r\n      constantField,\r\n      loginForm: {\r\n        username: \"\",\r\n        password: \"\",\r\n        code: \"\",\r\n        uuid: \"\"\r\n      },\r\n      bottomTitle: constantField.wholeName + '-' + constantField.name,\r\n      appUpdate,\r\n      appType: process.env.VUE_APP_TYPE,\r\n      passwordType: 'password',\r\n      showPwd: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.appUpdate.update()\r\n  },\r\n  methods: {\r\n    handleLogin() {\r\n      console.log(\"登录...\");\r\n      if (!this.loginForm.username){\r\n        return this.$toast.fail('请输入用户名');\r\n      }\r\n      if (!this.loginForm.password) {\r\n        return this.$toast.fail('请输入密码');\r\n      }\r\n      login({ username: this.loginForm.username, password: this.loginForm.password }).then(res => {\r\n        let userInfo = res.userInfo;\r\n        if (userInfo) {\r\n          if (!userInfo.deptId) {\r\n            this.$toast.fail(\"账户[\" + loginData.username + \"]未配置组织信息,请联系管理员\");\r\n            return false;\r\n          }\r\n          localStorage.setItem('userinfo', JSON.stringify(userInfo));\r\n          this.$store.dispatch('uploadOnlineState').then(() => {\r\n            this.$store.dispatch('getRealtimeOnline');\r\n          })\r\n          if (overviewGroups.indexOf(userInfo.GROUPID) >= 0) {\r\n            // this.$store.state.overviewAuth = true\r\n            localStorage.setItem('overviewAuth', true);\r\n            this.$router.push({ path: '/projectOverview' });\r\n          } else {\r\n            // this.$store.state.overviewAuth = false\r\n            localStorage.setItem('overviewAuth', false);\r\n            this.$router.push({ path: '/' });\r\n          }\r\n        } else {\r\n          this.$toast.fail('登录失败');\r\n        }\r\n      })\r\n    },\r\n    onSubmit_old(values) {\r\n      login(values).then(data => {\r\n        if (data && data.groupid) {\r\n          let groupid = data.groupid\r\n          data = data.loginData\r\n          data.groupid = groupid\r\n          let { id, name, token } = data\r\n          if (id && name && token) {\r\n            this.userauth(id).then(({ userAuth, roles, userInfo }) => {\r\n              data.userAuth = userAuth\r\n              data.roles = roles\r\n              data.groupname = userInfo.GROUPNAME\r\n              data.userinfo = userInfo\r\n              // if (userAuth.funCookie.indexOf(process.env.VUE_APP_TYPE) === -1) {\r\n              //   return this.$toast.fail('用户无权限进入，请联系管理员！')\r\n              // }\r\n              this.$store.state.userinfo = data\r\n              this.$store.state.loginCount++\r\n              localStorage.setItem('userinfo', JSON.stringify(data))\r\n\r\n              this.$store.dispatch('uploadOnlineState').then(() => {\r\n                this.$store.dispatch('getRealtimeOnline')\r\n              })\r\n              if (overviewGroups.indexOf(userInfo.GROUPID) >= 0) {\r\n                // this.$store.state.overviewAuth = true\r\n                localStorage.setItem('overviewAuth', true)\r\n                this.$router.push({ path: '/projectOverview' })\r\n              } else {\r\n                // this.$store.state.overviewAuth = false\r\n                localStorage.setItem('overviewAuth', false)\r\n                this.$router.push({ path: '/' })\r\n              }\r\n            })\r\n          } else {\r\n            this.$toast.fail(token || '登录失败')\r\n          }\r\n        } else {\r\n          this.$toast.fail(data ? '该角色没有配置角色权限,请到运维系统进行配置！' : '账号或密码错误！')\r\n        }\r\n      })\r\n    },\r\n    userauth(id) {\r\n      return new Promise(resolve => {\r\n        getUserInfo({\r\n          id,\r\n          type: 'app',\r\n          systemName: 'project'\r\n        }).then(data => {\r\n          resolve(data)\r\n        })\r\n      })\r\n    },\r\n    switchPasswordType() {\r\n      this.passwordType = this.passwordType === 'password' ? 'text' : 'password'\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.login-container {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: url(../../assets/image/bg_login.png) no-repeat;\r\n  background-size: 100% 100%;\r\n  .bg {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    .title {\r\n      width: 100%;\r\n      height: 44px;\r\n      font-size: 19px;\r\n      margin-top: 25px;\r\n      text-align: center;\r\n      font-family: SFPro-Semibold, SFPro;\r\n      font-weight: 600;\r\n      color: #fff;\r\n      line-height: 44px;\r\n    }\r\n    .card {\r\n      margin: 80px 40px 0px;\r\n      overflow:hidden;\r\n      .title {\r\n        text-align: initial;\r\n        height: 35px;\r\n        margin-top: 0px;\r\n        font-size: 25px;\r\n      }\r\n      ::v-deep .van-field {\r\n        margin-top: 22px;\r\n        height: 45px;\r\n        border-radius: 3px;\r\n        padding: initial;\r\n        padding-left: 10px;\r\n        .van-cell__value {\r\n          height: 100%;\r\n          .van-field__body {\r\n            height: 100% !important;\r\n\r\n            .van-field__control {\r\n              height: 100%;\r\n              background-color: transparent;\r\n            }\r\n            .van-field__right-icon {\r\n              margin-right: 0px;\r\n              display: flex;\r\n              .van-switch {\r\n                background: rgba(120, 120, 128, 0.32);\r\n                width: 1.8em;\r\n                border: 0px;\r\n                .van-switch__node {\r\n                  top: 0.1em;\r\n                  left: 0.1em;\r\n                  width: 0.8em;\r\n                  height: 0.8em;\r\n                }\r\n              }\r\n              .van-switch--on {\r\n                background-color: #1989fa;\r\n                .van-switch__node {\r\n                  -webkit-transform: translateX(0.8em);\r\n                  transform: translateX(0.8em);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .van-button {\r\n        margin-top: 40px;\r\n        border-radius: 3px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}