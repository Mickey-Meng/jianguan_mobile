{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\quality\\check.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\quality\\check.vue","mtime":1684246188005},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1684411446344},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgVXBsb2FkIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vVXBsb2FkJw0KaW1wb3J0IFNlbGVjdGVyIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vU2VsZWN0ZXInDQppbXBvcnQgew0KICBnZXRRdWFsaXR5VHJlZSwNCiAgZ2V0U2FmZUNoZWNrLA0KICB1cGxvYWRRdWFsaXR5RGF0YSwNCiAgZ2V0R29uZ1F1TmV3LA0KICBnZXRHb25nUXVQcm9qZWN0LA0KICBnZXREZWxheVF1YWxpdHlFdmVudCwNCiAgZG9EZWxheVF1YWxpdHlFdmVudA0KfSBmcm9tICdAL2FwaS9wcm9qZWN0LmpzJw0KaW1wb3J0IHsgZm9ybWF0SVNPODYwMVRpbWUgfSBmcm9tICdAL3V0aWxzL2luZGV4Jw0KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHsNCiAgICBVcGxvYWQsDQogICAgU2VsZWN0ZXINCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZWRpdERhdGE6IHsNCiAgICAgICAgc2FmZWZpcnN0bmFtZTogJycsDQogICAgICAgIHNhZmVzZWNvbmRuYW1lOiAnJywNCiAgICAgICAgbW9kaWZ5bmFtZTogJycsDQogICAgICAgIG1vZGlmeWRhdGU6IDMNCiAgICAgIH0sDQogICAgICBmaXJzdEFjdGlvbnM6IFtdLA0KICAgICAgc2Vjb25kQWN0aW9uczogW10sDQogICAgICBjaGVja0FjdGlvbnM6IFtdLA0KICAgICAgc2hvd0ZpcnN0OiBmYWxzZSwNCiAgICAgIHNob3dTZWNvbmQ6IGZhbHNlLA0KICAgICAgdXJsTGlzdDogW10sDQogICAgICBzaG93UGlja2VyOiBmYWxzZSwNCiAgICAgIGZvcm1hdElTTzg2MDFUaW1lLA0KICAgICAgZ29uZ1F1QWN0aW9uczogW10sDQogICAgICBzaG93R29uZ1F1OiBmYWxzZSwNCiAgICAgIHByb2plY3RBY3Rpb25zOiBbXSwNCiAgICAgIHNob3dQcm9qZWN0OiBmYWxzZSwNCiAgICAgIGN1cnJlbnREYXRlOiBuZXcgRGF0ZSgpLA0KICAgICAgbGlzdDogW10sDQogICAgICBmaW5pc2hlZDogZmFsc2UsDQogICAgICByZWZyZXNoaW5nOiBmYWxzZSwNCiAgICAgIHNob3c6IGZhbHNlLA0KICAgICAgZGVsYXlJdGVtOiB7IHJlYXNvbjogJycgfSwNCiAgICAgIHRpdGxlOiAn6YCa6L+HJw0KICAgIH0NCiAgfSwNCg0KICBjb21wdXRlZDogew0KICAgIHNjcm9sbGVySGVpZ2h0OiBmdW5jdGlvbigpIHsNCiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgLSAxNDYgKyAncHgnDQogICAgfSwNCiAgICAuLi5tYXBHZXR0ZXJzKFsnY3VycmVudEJpYW9EdWFuJ10pDQogIH0sDQoNCiAgbW91bnRlZCgpIHt9LA0KDQogIGNyZWF0ZWQoKSB7DQogICAgbGV0IHVzZXJJbmZvID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcmluZm8nKSkNCiAgICB0aGlzLmVkaXREYXRhLnVwbG9hZGlkID0gdXNlckluZm8uaWQNCiAgICB0aGlzLmVkaXREYXRhLnVwbG9hZG5hbWUgPSB1c2VySW5mby5uYW1lDQogICAgdGhpcy5yZXF1ZXN0Rmlyc3QoKQ0KICAgIGdldEdvbmdRdU5ldyh0aGlzLiRzdG9yZS5zdGF0ZS5jdXJQcm9qZWN0LmNoaWxkWzBdLmlkKS50aGVuKGRhdGEgPT4gew0KICAgICAgdGhpcy5nb25nUXVBY3Rpb25zID0gZGF0YQ0KICAgICAgZGF0YSAmJiBkYXRhLmxlbmd0aCAhPT0gMCAmJiB0aGlzLm9uU2VsZWN0R29uZ3F1KGRhdGFbMF0pDQogICAgfSkNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgb25TZWxlY3RGaXJzdChpdGVtKSB7DQogICAgICB0aGlzLnNob3dGaXJzdCA9IGZhbHNlDQogICAgICB0aGlzLmVkaXREYXRhLnF1YWxpdHlmaXJzdG5hbWUgPSBpdGVtLm5hbWUNCiAgICAgIHRoaXMuZWRpdERhdGEucXVhbGl0eWZpcnN0ID0gaXRlbS5pZA0KICAgICAgdGhpcy5yZXF1ZXN0U2Vjb25kKGl0ZW0uaWQpDQogICAgfSwNCiAgICBvblNlbGVjdFNlY29uZChpdGVtKSB7DQogICAgICB0aGlzLnNob3dTZWNvbmQgPSBmYWxzZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5xdWFsaXR5c2Vjb25kbmFtZSA9IGl0ZW0ubmFtZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5xdWFsaXR5c2Vjb25kID0gaXRlbS5pZA0KICAgIH0sDQogICAgb25TZWxlY3RDaGVjayhpdGVtKSB7DQogICAgICB0aGlzLmVkaXREYXRhLm1vZGlmeW5hbWUgPSBpdGVtLm5hbWUNCiAgICAgIHRoaXMuZWRpdERhdGEubW9kaWZ5aWQgPSBpdGVtLmlkDQogICAgfSwNCiAgICBvblNlbGVjdEdvbmdxdShpdGVtKSB7DQogICAgICB0aGlzLnNob3dHb25nUXUgPSBmYWxzZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5nb25ncXVOYW1lID0gaXRlbS5uYW1lDQogICAgICB0aGlzLmVkaXREYXRhLmdvbmdxdWlkID0gaXRlbS5zb3J0DQoNCiAgICAgIGdldEdvbmdRdVByb2plY3QoeyBpZDogaXRlbS5zb3J0IH0pLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoaXMucHJvamVjdEFjdGlvbnMgPSBkYXRhDQogICAgICB9KQ0KDQogICAgICB0aGlzLnJlcXVlc3RDaGVja2VyKCkNCiAgICB9LA0KICAgIG9uU2VsZWN0UHJvamVjdChpdGVtKSB7DQogICAgICB0aGlzLnNob3dQcm9qZWN0ID0gZmFsc2UNCiAgICAgIHRoaXMuZWRpdERhdGEucHJvamVjdE5hbWUgPSBpdGVtLm5hbWUNCiAgICAgIHRoaXMuZWRpdERhdGEuc2luZ2xlUHJvamVjdElkID0gaXRlbS5pZA0KICAgIH0sDQogICAgb25Db25maXJtKHRpbWUpIHsNCiAgICAgIHRoaXMuc2hvd1BpY2tlciA9IGZhbHNlDQogICAgICB0aGlzLmVkaXREYXRhLnVwbG9hZHRpbWUgPSB0aGlzLmZvcm1hdElTTzg2MDFUaW1lKG5ldyBEYXRlKHRpbWUpLnRvSlNPTigpKQ0KICAgIH0sDQogICAgcmVxdWVzdENoZWNrZXIoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIGdldFNhZmVDaGVjayh7IGdyb3VwOiB0aGlzLmVkaXREYXRhLmdvbmdxdWlkLHByb2plY3RJZDogdGhpcy4kc3RvcmUuc3RhdGUuY3VyUHJvamVjdC5jaGlsZFswXS5pZCB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGF0LmNoZWNrQWN0aW9ucyA9IGRhdGENCiAgICAgICAgdGhpcy5vblNlbGVjdENoZWNrKHRoYXQuY2hlY2tBY3Rpb25zWzBdKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHJlcXVlc3RGaXJzdCgpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpcw0KICAgICAgZ2V0UXVhbGl0eVRyZWUoKS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGF0LmZpcnN0QWN0aW9ucyA9IGRhdGENCiAgICAgICAgdGhpcy5vblNlbGVjdEZpcnN0KGRhdGFbMF0pDQogICAgICB9KQ0KICAgIH0sDQogICAgcmVxdWVzdFNlY29uZChpZCkgew0KICAgICAgbGV0IHRoYXQgPSB0aGlzDQogICAgICBnZXRRdWFsaXR5VHJlZSh7IGlkOiBpZCB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGF0LnNlY29uZEFjdGlvbnMgPSBkYXRhDQogICAgICAgIHRoYXQuZWRpdERhdGEuc2FmZXNlY29uZG5hbWUgPSBkYXRhWzBdLm5hbWUNCiAgICAgICAgdGhhdC5lZGl0RGF0YS5zYWZlc2Vjb25kID0gZGF0YVswXS5pZA0KICAgICAgfSkNCiAgICB9LA0KICAgIG9uU3VibWl0KHZhbHVlcykgew0KICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZWRpdERhdGEpKQ0KICAgICAgZGF0YS5wcm9qZWN0SWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50Qmlhb0R1YW4uaWQNCiAgICAgIGRhdGEubW9kaWZ5ZGF0ZSA9IHBhcnNlSW50KGRhdGEubW9kaWZ5ZGF0ZSkNCiAgICAgIGxldCB0ZW1wID0gW10NCiAgICAgIHZhbHVlcy51cGxvYWR1cmwuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbS51cmwgJiYgdGVtcC5wdXNoKGl0ZW0udXJsKQ0KICAgICAgfSkNCiAgICAgIGlmKHZhbHVlcy51cGxvYWR1cmwubGVuZ3RoICE9PSB0ZW1wLmxlbmd0aCl7DQogICAgICAgICByZXR1cm4gdGhpcy4kbm90aWZ5KHsgdHlwZTogJ3dhcm5pbmcnLCBtZXNzYWdlOiAn6K+35LiK5Lyg5paH5Lu25oiW562J5b6F5paH5Lu25LiK5Lyg5a6M5oiQ77yBJyB9KQ0KICAgICAgfQ0KICAgICAgZGF0YS51cGxvYWR1cmwgPSB0ZW1wLmpvaW4oJywnKQ0KICAgICAgdXBsb2FkUXVhbGl0eURhdGEoZGF0YSkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuJG5vdGlmeSh7DQogICAgICAgICAgbWVzc2FnZTogJ+aPkOS6pOaIkOWKn++8gScsDQogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgIH0pDQogICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBvbkxvYWQoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIGdldERlbGF5UXVhbGl0eUV2ZW50KHsncHJvamVjdElkJzp0aGlzLmN1cnJlbnRCaWFvRHVhbi5pZH0pLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoYXQubGlzdCA9IGRhdGEgfHwgW10NCiAgICAgICAgdGhhdC5yZWZyZXNoaW5nID0gZmFsc2UNCiAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUNCiAgICAgIH0pDQogICAgfSwNCiAgICBpdGVtQ2xpY2soaXRlbSkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICBuYW1lOiAnZGV0YWlsJywNCiAgICAgICAgcGFyYW1zOiBpdGVtDQogICAgICB9KQ0KICAgIH0sDQogICAgZG9EZWxheVF1YWxpdHlFdmVudChpdGVtLCByZXN1bHQpIHsNCiAgICAgIHRoaXMudGl0bGUgPSByZXN1bHQgPT09IDEgPyAn6YCa6L+HJyA6ICfkuI3pgJrov4cnDQogICAgICB0aGlzLnNob3cgPSB0cnVlDQogICAgICB0aGlzLmRlbGF5SXRlbS5yZXN1bHQgPSByZXN1bHQNCiAgICAgIHRoaXMuZGVsYXlJdGVtLmV2ZW50aWQgPSBpdGVtLmlkDQogICAgfSwNCiAgICBzdWJtaXQoYWN0aW9uLCBkb25lKSB7DQogICAgICBpZiAoYWN0aW9uID09PSAnY2FuY2VsJykgew0KICAgICAgICBkb25lKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGRvRGVsYXlRdWFsaXR5RXZlbnQodGhpcy5kZWxheUl0ZW0pLnRoZW4oZGF0YSA9PiB7DQogICAgICAgICAgdGhpcy4kdG9hc3QoJ+WkhOeQhuaIkOWKnycpDQogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dldFJlYWx0aW1lTWVzc2FnZScpDQogICAgICAgICAgZG9uZSgpDQogICAgICAgICAgdGhpcy5vbkxvYWQoKQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["check.vue"],"names":[],"mappings":";AAsKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"check.vue","sourceRoot":"src/views/project/quality","sourcesContent":["<template>\r\n  <div class=\"report\">\r\n    <van-tabs>\r\n      <van-tab title=\"质量检查\">\r\n        <van-form @submit=\"onSubmit\" :v-model=\"editData\" class=\"common-card\" :style=\"{ height: scrollerHeight }\">\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.qualityfirstname\"\r\n            label=\"质量大类\"\r\n            placeholder=\"质量大类\"\r\n            @click=\"showFirst = true\"\r\n            :rules=\"[{ required: true, message: '请选质量大类' }]\"\r\n          />\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.qualitysecondname\"\r\n            label=\"质量小类\"\r\n            placeholder=\"质量小类\"\r\n            @click=\"showSecond = true\"\r\n            :rules=\"[{ required: true, message: '请选质量小类' }]\"\r\n          />\r\n          <van-field\r\n            v-model=\"editData.uploadtime\"\r\n            is-link\r\n            readonly\r\n            name=\"uploadtime\"\r\n            label=\"检查日期\"\r\n            placeholder=\"点击选择检查日期\"\r\n            @click=\"showPicker = true\"\r\n            :rules=\"[{ required: true, message: '请选择检查日期' }]\"\r\n          />\r\n          <van-field\r\n            type=\"textarea\"\r\n            rows=\"2\"\r\n            v-model=\"editData.uploadremark\"\r\n            name=\"uploadremark\"\r\n            label=\"问题描述\"\r\n            placeholder=\"问题描述\"\r\n          />\r\n          <upload\r\n            label=\"照片\"\r\n            name=\"uploadurl\"\r\n            :fileList=\"urlList\"\r\n            :rules=\"[{ required: true, message: '请选择照片' }]\"\r\n          ></upload>\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.gongquName\"\r\n            label=\"工区\"\r\n            placeholder=\"工区\"\r\n            @click=\"showGongQu = true\"\r\n            :rules=\"[{ required: true, message: '请选工区' }]\"\r\n          />\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.projectName\"\r\n            label=\"单位工程\"\r\n            placeholder=\"单位工程\"\r\n            @click=\"showProject = true\"\r\n            :rules=\"[{ required: true, message: '请选单位工程' }]\"\r\n          />\r\n          <Selecter\r\n            readonly\r\n            clickable\r\n            :value=\"editData.modifyname\"\r\n            label=\"责任人\"\r\n            placeholder=\"责任人\"\r\n            :rules=\"[{ required: true, message: '请选责任人' }]\"\r\n            :actions=\"checkActions\"\r\n            :onSelect=\"onSelectCheck\"\r\n          ></Selecter>\r\n          <van-field\r\n            type=\"digit\"\r\n            v-model=\"editData.modifydate\"\r\n            name=\"modifydate\"\r\n            label=\"整改期限\"\r\n            placeholder=\"整改期限\"\r\n            :rules=\"[{ required: true, message: '请填整改期限' }]\"\r\n          />\r\n\r\n          <div style=\"margin: 4px 16px\">\r\n            <van-button size=\"small\" round block type=\"info\" native-type=\"submit\">提交</van-button>\r\n          </div>\r\n        </van-form>\r\n      </van-tab>\r\n      <van-tab title=\"延期审核\">\r\n        <van-list\r\n          :finished=\"finished\"\r\n          finished-text=\"我也是有底线的~~\"\r\n          @load=\"onLoad\"\r\n          class=\"common-list common-card\"\r\n          :style=\"{ height: scrollerHeight }\"\r\n        >\r\n          <div\r\n            @click=\"itemClick(item, 0)\"\r\n            v-for=\"(item, index) in list\"\r\n            :key=\"index\"\r\n            :class=\"'item ' + (index === list.length - 1 ? 'last' : '')\"\r\n          >\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查时间：</span>\r\n              <span class=\"value\">{{ item.uploadtime }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查人：</span>\r\n              <span class=\"value\">{{ item.uploadname }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查备注：</span>\r\n              <span class=\"value\">{{ item.uploadremark }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">整改期限：</span>\r\n              <span class=\"value\">{{ item.modifydate }} 天</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">申请延期：</span>\r\n              <span class=\"value\">{{ item.delayday }} 天</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">延期原因：</span>\r\n              <span class=\"value\">{{ item.delayreason }}</span>\r\n            </div>\r\n            <div class=\"operate center-in-vertical\">\r\n              <van-button\r\n                v-if=\"item.delayresult === 1\"\r\n                class=\"button\"\r\n                type=\"primary\"\r\n                size=\"small\"\r\n                @click.stop=\"doDelayQualityEvent(item, 1)\"\r\n                >通过</van-button\r\n              >\r\n              <van-button\r\n                v-if=\"item.delayresult === 1\"\r\n                class=\"button\"\r\n                type=\"danger\"\r\n                size=\"small\"\r\n                @click.stop=\"doDelayQualityEvent(item, 2)\"\r\n                >不通过</van-button\r\n              >\r\n            </div>\r\n          </div>\r\n        </van-list>\r\n      </van-tab>\r\n    </van-tabs>\r\n    <van-action-sheet v-model=\"showFirst\" :actions=\"firstActions\" @select=\"onSelectFirst\" />\r\n    <van-action-sheet v-model=\"showSecond\" :actions=\"secondActions\" @select=\"onSelectSecond\" />\r\n    <van-action-sheet v-model=\"showGongQu\" :actions=\"gongQuActions\" @select=\"onSelectGongqu\" />\r\n    <van-action-sheet v-model=\"showProject\" :actions=\"projectActions\" @select=\"onSelectProject\" />\r\n    <van-popup v-model=\"showPicker\" position=\"bottom\">\r\n      <van-datetime-picker v-model=\"currentDate\" type=\"datetime\" @confirm=\"onConfirm\" @cancel=\"showPicker = false\" />\r\n    </van-popup>\r\n\r\n    <van-dialog v-model=\"show\" :title=\"title\" show-cancel-button :beforeClose=\"submit\">\r\n      <van-form v-model=\"delayItem\">\r\n        <van-field type=\"textarea\" v-model=\"delayItem.reason\" name=\"uploadremark\" label=\"原因\" placeholder=\"原因\" />\r\n      </van-form>\r\n    </van-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Upload from '@/components/common/Upload'\r\nimport Selecter from '@/components/common/Selecter'\r\nimport {\r\n  getQualityTree,\r\n  getSafeCheck,\r\n  uploadQualityData,\r\n  getGongQuNew,\r\n  getGongQuProject,\r\n  getDelayQualityEvent,\r\n  doDelayQualityEvent\r\n} from '@/api/project.js'\r\nimport { formatISO8601Time } from '@/utils/index'\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  components: {\r\n    Upload,\r\n    Selecter\r\n  },\r\n  data() {\r\n    return {\r\n      editData: {\r\n        safefirstname: '',\r\n        safesecondname: '',\r\n        modifyname: '',\r\n        modifydate: 3\r\n      },\r\n      firstActions: [],\r\n      secondActions: [],\r\n      checkActions: [],\r\n      showFirst: false,\r\n      showSecond: false,\r\n      urlList: [],\r\n      showPicker: false,\r\n      formatISO8601Time,\r\n      gongQuActions: [],\r\n      showGongQu: false,\r\n      projectActions: [],\r\n      showProject: false,\r\n      currentDate: new Date(),\r\n      list: [],\r\n      finished: false,\r\n      refreshing: false,\r\n      show: false,\r\n      delayItem: { reason: '' },\r\n      title: '通过'\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    scrollerHeight: function() {\r\n      return window.innerHeight - 146 + 'px'\r\n    },\r\n    ...mapGetters(['currentBiaoDuan'])\r\n  },\r\n\r\n  mounted() {},\r\n\r\n  created() {\r\n    let userInfo = JSON.parse(localStorage.getItem('userinfo'))\r\n    this.editData.uploadid = userInfo.id\r\n    this.editData.uploadname = userInfo.name\r\n    this.requestFirst()\r\n    getGongQuNew(this.$store.state.curProject.child[0].id).then(data => {\r\n      this.gongQuActions = data\r\n      data && data.length !== 0 && this.onSelectGongqu(data[0])\r\n    })\r\n  },\r\n\r\n  methods: {\r\n    onSelectFirst(item) {\r\n      this.showFirst = false\r\n      this.editData.qualityfirstname = item.name\r\n      this.editData.qualityfirst = item.id\r\n      this.requestSecond(item.id)\r\n    },\r\n    onSelectSecond(item) {\r\n      this.showSecond = false\r\n      this.editData.qualitysecondname = item.name\r\n      this.editData.qualitysecond = item.id\r\n    },\r\n    onSelectCheck(item) {\r\n      this.editData.modifyname = item.name\r\n      this.editData.modifyid = item.id\r\n    },\r\n    onSelectGongqu(item) {\r\n      this.showGongQu = false\r\n      this.editData.gongquName = item.name\r\n      this.editData.gongquid = item.sort\r\n\r\n      getGongQuProject({ id: item.sort }).then(data => {\r\n        this.projectActions = data\r\n      })\r\n\r\n      this.requestChecker()\r\n    },\r\n    onSelectProject(item) {\r\n      this.showProject = false\r\n      this.editData.projectName = item.name\r\n      this.editData.singleProjectId = item.id\r\n    },\r\n    onConfirm(time) {\r\n      this.showPicker = false\r\n      this.editData.uploadtime = this.formatISO8601Time(new Date(time).toJSON())\r\n    },\r\n    requestChecker() {\r\n      let that = this\r\n      getSafeCheck({ group: this.editData.gongquid,projectId: this.$store.state.curProject.child[0].id }).then(data => {\r\n        that.checkActions = data\r\n        this.onSelectCheck(that.checkActions[0])\r\n      })\r\n    },\r\n    requestFirst() {\r\n      let that = this\r\n      getQualityTree().then(data => {\r\n        that.firstActions = data\r\n        this.onSelectFirst(data[0])\r\n      })\r\n    },\r\n    requestSecond(id) {\r\n      let that = this\r\n      getQualityTree({ id: id }).then(data => {\r\n        that.secondActions = data\r\n        that.editData.safesecondname = data[0].name\r\n        that.editData.safesecond = data[0].id\r\n      })\r\n    },\r\n    onSubmit(values) {\r\n      let data = JSON.parse(JSON.stringify(this.editData))\r\n      data.projectId = this.$store.state.currentBiaoDuan.id\r\n      data.modifydate = parseInt(data.modifydate)\r\n      let temp = []\r\n      values.uploadurl.forEach(item => {\r\n        item.url && temp.push(item.url)\r\n      })\r\n      if(values.uploadurl.length !== temp.length){\r\n         return this.$notify({ type: 'warning', message: '请上传文件或等待文件上传完成！' })\r\n      }\r\n      data.uploadurl = temp.join(',')\r\n      uploadQualityData(data).then(() => {\r\n        this.$notify({\r\n          message: '提交成功！',\r\n          type: 'success'\r\n        })\r\n        this.$router.go(-1)\r\n      })\r\n    },\r\n    onLoad() {\r\n      let that = this\r\n      getDelayQualityEvent({'projectId':this.currentBiaoDuan.id}).then(data => {\r\n        that.list = data || []\r\n        that.refreshing = false\r\n        this.finished = true\r\n      })\r\n    },\r\n    itemClick(item) {\r\n      this.$router.push({\r\n        name: 'detail',\r\n        params: item\r\n      })\r\n    },\r\n    doDelayQualityEvent(item, result) {\r\n      this.title = result === 1 ? '通过' : '不通过'\r\n      this.show = true\r\n      this.delayItem.result = result\r\n      this.delayItem.eventid = item.id\r\n    },\r\n    submit(action, done) {\r\n      if (action === 'cancel') {\r\n        done()\r\n      } else {\r\n        doDelayQualityEvent(this.delayItem).then(data => {\r\n          this.$toast('处理成功')\r\n          this.$store.dispatch('getRealtimeMessage')\r\n          done()\r\n          this.onLoad()\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}