{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\security\\report.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\security\\report.vue","mtime":1684246188049},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1684411446344},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgVXBsb2FkIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vVXBsb2FkJw0KaW1wb3J0IFNlbGVjdGVyIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vU2VsZWN0ZXInDQppbXBvcnQgew0KICBnZXRTYWZlVHJlZSwNCiAgZ2V0U2FmZUNoZWNrLA0KICB1cGxvYWRTYWZlRGF0YSwNCiAgZ2V0R29uZ1F1TmV3LA0KICBnZXRHb25nUXVQcm9qZWN0LA0KICBnZXREZWxheVNhZmVFdmVudCwNCiAgZG9EZWxheVNhZmVFdmVudA0KfSBmcm9tICdAL2FwaS9wcm9qZWN0LmpzJw0KaW1wb3J0IHsgZm9ybWF0SVNPODYwMVRpbWUgfSBmcm9tICdAL3V0aWxzL2luZGV4Jw0KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHsNCiAgICBVcGxvYWQsDQogICAgU2VsZWN0ZXINCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZWRpdERhdGE6IHsNCiAgICAgICAgc2FmZWZpcnN0bmFtZTogJycsDQogICAgICAgIHNhZmVzZWNvbmRuYW1lOiAnJywNCiAgICAgICAgbW9kaWZ5bmFtZTogJycsDQogICAgICAgIG1vZGlmeWRhdGU6IDMNCiAgICAgIH0sDQogICAgICBmaXJzdEFjdGlvbnM6IFtdLA0KICAgICAgc2Vjb25kQWN0aW9uczogW10sDQogICAgICBjaGVja0FjdGlvbnM6IFtdLA0KICAgICAgc2hvd0ZpcnN0OiBmYWxzZSwNCiAgICAgIHNob3dTZWNvbmQ6IGZhbHNlLA0KICAgICAgdXJsTGlzdDogW10sDQogICAgICBzaG93UGlja2VyOiBmYWxzZSwNCiAgICAgIGZvcm1hdElTTzg2MDFUaW1lLA0KICAgICAgZ29uZ1F1QWN0aW9uczogW10sDQogICAgICBzaG93R29uZ1F1OiBmYWxzZSwNCiAgICAgIHByb2plY3RBY3Rpb25zOiBbXSwNCiAgICAgIHNob3dQcm9qZWN0OiBmYWxzZSwNCiAgICAgIGN1cnJlbnREYXRlOiBuZXcgRGF0ZSgpLA0KDQogICAgICBsaXN0OiBbXSwNCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIHJlZnJlc2hpbmc6IGZhbHNlLA0KICAgICAgc2hvdzogZmFsc2UsDQogICAgICBkZWxheUl0ZW06IHsgcmVhc29uOiAnJyB9LA0KICAgICAgdGl0bGU6ICfpgJrov4cnDQogICAgfQ0KICB9LA0KDQogIGNvbXB1dGVkOiB7DQogICAgc2Nyb2xsZXJIZWlnaHQ6IGZ1bmN0aW9uKCkgew0KICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCAtIDE0NiArICdweCcNCiAgICB9LA0KICAgIC4uLm1hcEdldHRlcnMoWydjdXJyZW50Qmlhb0R1YW4nXSkNCiAgfSwNCg0KICBtb3VudGVkKCkge30sDQoNCiAgY3JlYXRlZCgpIHsNCiAgICBsZXQgdXNlckluZm8gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyaW5mbycpKQ0KICAgIHRoaXMuZWRpdERhdGEudXBsb2FkaWQgPSB1c2VySW5mby5pZA0KICAgIHRoaXMuZWRpdERhdGEudXBsb2FkbmFtZSA9IHVzZXJJbmZvLm5hbWUNCiAgICB0aGlzLnJlcXVlc3RGaXJzdCgpDQogICAgZ2V0R29uZ1F1TmV3KHRoaXMuJHN0b3JlLnN0YXRlLmN1clByb2plY3QuY2hpbGRbMF0uaWQpLnRoZW4oZGF0YSA9PiB7DQogICAgICB0aGlzLmdvbmdRdUFjdGlvbnMgPSBkYXRhDQogICAgICBkYXRhICYmIGRhdGEubGVuZ3RoICE9PSAwICYmIHRoaXMub25TZWxlY3RHb25ncXUoZGF0YVswXSkNCiAgICB9KQ0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBvblNlbGVjdEZpcnN0KGl0ZW0pIHsNCiAgICAgIHRoaXMuc2hvd0ZpcnN0ID0gZmFsc2UNCiAgICAgIHRoaXMuZWRpdERhdGEuc2FmZWZpcnN0bmFtZSA9IGl0ZW0ubmFtZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5zYWZlZmlyc3QgPSBpdGVtLmlkDQogICAgICB0aGlzLnJlcXVlc3RTZWNvbmQoaXRlbS5pZCkNCiAgICB9LA0KICAgIG9uU2VsZWN0U2Vjb25kKGl0ZW0pIHsNCiAgICAgIHRoaXMuc2hvd1NlY29uZCA9IGZhbHNlDQogICAgICB0aGlzLmVkaXREYXRhLnNhZmVzZWNvbmRuYW1lID0gaXRlbS5uYW1lDQogICAgICB0aGlzLmVkaXREYXRhLnNhZmVzZWNvbmQgPSBpdGVtLmlkDQogICAgfSwNCiAgICBvblNlbGVjdENoZWNrKGl0ZW0pIHsNCiAgICAgIHRoaXMuZWRpdERhdGEubW9kaWZ5bmFtZSA9IGl0ZW0ubmFtZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5tb2RpZnlpZCA9IGl0ZW0uaWQNCiAgICB9LA0KICAgIG9uU2VsZWN0R29uZ3F1KGl0ZW0pIHsNCiAgICAgIHRoaXMuc2hvd0dvbmdRdSA9IGZhbHNlDQogICAgICB0aGlzLmVkaXREYXRhLmdvbmdxdU5hbWUgPSBpdGVtLm5hbWUNCiAgICAgIHRoaXMuZWRpdERhdGEuZ29uZ3F1aWQgPSBpdGVtLnNvcnQNCg0KICAgICAgZ2V0R29uZ1F1UHJvamVjdCh7IGlkOiBpdGVtLnNvcnQgfSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdGhpcy5wcm9qZWN0QWN0aW9ucyA9IGRhdGENCiAgICAgIH0pDQoNCiAgICAgIHRoaXMucmVxdWVzdENoZWNrZXIoKQ0KICAgIH0sDQogICAgb25TZWxlY3RQcm9qZWN0KGl0ZW0pIHsNCiAgICAgIHRoaXMuc2hvd1Byb2plY3QgPSBmYWxzZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5wcm9qZWN0TmFtZSA9IGl0ZW0ubmFtZQ0KICAgICAgdGhpcy5lZGl0RGF0YS5zaW5nbGVQcm9qZWN0SWQgPSBpdGVtLmlkDQogICAgfSwNCiAgICBvbkNvbmZpcm0odGltZSkgew0KICAgICAgdGhpcy5zaG93UGlja2VyID0gZmFsc2UNCiAgICAgIHRoaXMuZWRpdERhdGEudXBsb2FkdGltZSA9IHRoaXMuZm9ybWF0SVNPODYwMVRpbWUobmV3IERhdGUodGltZSkudG9KU09OKCkpDQogICAgfSwNCiAgICByZXF1ZXN0Q2hlY2tlcigpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpcw0KICAgICAgZ2V0U2FmZUNoZWNrKHsgZ3JvdXA6IHRoaXMuZWRpdERhdGEuZ29uZ3F1aWQscHJvamVjdElkOiB0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50Qmlhb0R1YW4uaWQgfSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdGhhdC5jaGVja0FjdGlvbnMgPSBkYXRhDQogICAgICAgIHRoaXMub25TZWxlY3RDaGVjayh0aGF0LmNoZWNrQWN0aW9uc1swXSkNCiAgICAgIH0pDQogICAgfSwNCiAgICByZXF1ZXN0Rmlyc3QoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIGdldFNhZmVUcmVlKCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdGhhdC5maXJzdEFjdGlvbnMgPSBkYXRhDQogICAgICAgIHRoaXMub25TZWxlY3RGaXJzdChkYXRhWzBdKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHJlcXVlc3RTZWNvbmQoaWQpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpcw0KICAgICAgZ2V0U2FmZVRyZWUoeyBpZDogaWQgfSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdGhhdC5zZWNvbmRBY3Rpb25zID0gZGF0YQ0KICAgICAgICB0aGF0LmVkaXREYXRhLnNhZmVzZWNvbmRuYW1lID0gZGF0YVswXS5uYW1lDQogICAgICAgIHRoYXQuZWRpdERhdGEuc2FmZXNlY29uZCA9IGRhdGFbMF0uaWQNCiAgICAgIH0pDQogICAgfSwNCiAgICBvblN1Ym1pdCh2YWx1ZXMpIHsNCiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmVkaXREYXRhKSkNCiAgICAgIGRhdGEubW9kaWZ5ZGF0ZSA9IHBhcnNlSW50KGRhdGEubW9kaWZ5ZGF0ZSkNCiAgICAgIGRhdGEucHJvamVjdElkID0gdGhpcy4kc3RvcmUuc3RhdGUuY3VycmVudEJpYW9EdWFuLmlkDQogICAgICBsZXQgdGVtcCA9IFtdDQogICAgICB2YWx1ZXMudXBsb2FkdXJsLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgIGl0ZW0udXJsICYmIHRlbXAucHVzaChpdGVtLnVybCkNCiAgICAgIH0pDQogICAgICBpZih2YWx1ZXMudXBsb2FkdXJsLmxlbmd0aCAhPT0gdGVtcC5sZW5ndGgpew0KICAgICAgICAgcmV0dXJuIHRoaXMuJG5vdGlmeSh7IHR5cGU6ICd3YXJuaW5nJywgbWVzc2FnZTogJ+ivt+S4iuS8oOaWh+S7tuaIluetieW+heaWh+S7tuS4iuS8oOWujOaIkO+8gScgfSkNCiAgICAgIH0NCiAgICAgIGRhdGEudXBsb2FkdXJsID0gdGVtcC5qb2luKCcsJykNCiAgICAgIHVwbG9hZFNhZmVEYXRhKGRhdGEpLnRoZW4oKCkgPT4gew0KICAgICAgICB0aGlzLiRub3RpZnkoew0KICAgICAgICAgIG1lc3NhZ2U6ICfmj5DkuqTmiJDlip/vvIEnLA0KICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJw0KICAgICAgICB9KQ0KICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpDQogICAgICB9KQ0KICAgIH0sDQoNCiAgICBvbkxvYWQoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIGdldERlbGF5U2FmZUV2ZW50KHsncHJvamVjdElkJzp0aGlzLmN1cnJlbnRCaWFvRHVhbi5pZH0pLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoYXQubGlzdCA9IGRhdGEgfHwgW10NCiAgICAgICAgdGhhdC5yZWZyZXNoaW5nID0gZmFsc2UNCiAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUNCiAgICAgIH0pDQogICAgfSwNCiAgICBpdGVtQ2xpY2soaXRlbSkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICBuYW1lOiAnc2VjdXJpdHlEZXRhaWwnLA0KICAgICAgICBwYXJhbXM6IGl0ZW0NCiAgICAgIH0pDQogICAgfSwNCiAgICBkb0RlbGF5U2FmZUV2ZW50KGl0ZW0sIHJlc3VsdCkgew0KICAgICAgdGhpcy50aXRsZSA9IHJlc3VsdCA9PT0gMSA/ICfpgJrov4cnIDogJ+S4jemAmui/hycNCiAgICAgIHRoaXMuc2hvdyA9IHRydWUNCiAgICAgIHRoaXMuZGVsYXlJdGVtLnJlc3VsdCA9IHJlc3VsdA0KICAgICAgdGhpcy5kZWxheUl0ZW0uZXZlbnRpZCA9IGl0ZW0uaWQNCiAgICB9LA0KICAgIHN1Ym1pdChhY3Rpb24sIGRvbmUpIHsNCiAgICAgIGlmIChhY3Rpb24gPT09ICdjYW5jZWwnKSB7DQogICAgICAgIGRvbmUoKQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgZG9EZWxheVNhZmVFdmVudCh0aGlzLmRlbGF5SXRlbSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgICB0aGlzLiR0b2FzdCgn5aSE55CG5oiQ5YqfJykNCiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ2V0UmVhbHRpbWVNZXNzYWdlJykNCiAgICAgICAgICBkb25lKCkNCiAgICAgICAgICB0aGlzLm9uTG9hZCgpDQogICAgICAgIH0pDQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["report.vue"],"names":[],"mappings":";AAuKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"report.vue","sourceRoot":"src/views/project/security","sourcesContent":["<template>\r\n  <div class=\"report\">\r\n    <van-tabs>\r\n      <van-tab title=\"安全检查\">\r\n        <van-form @submit=\"onSubmit\" :v-model=\"editData\" class=\"common-card\" :style=\"{ height: scrollerHeight }\">\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.safefirstname\"\r\n            label=\"问题大类\"\r\n            placeholder=\"问题大类\"\r\n            @click=\"showFirst = true\"\r\n            :rules=\"[{ required: true, message: '请选问题大类' }]\"\r\n          />\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.safesecondname\"\r\n            label=\"问题小类\"\r\n            placeholder=\"问题小类\"\r\n            @click=\"showSecond = true\"\r\n            :rules=\"[{ required: true, message: '请选问题小类' }]\"\r\n          />\r\n          <van-field\r\n            v-model=\"editData.uploadtime\"\r\n            is-link\r\n            readonly\r\n            name=\"uploadtime\"\r\n            label=\"检查日期\"\r\n            placeholder=\"点击选择检查日期\"\r\n            @click=\"showPicker = true\"\r\n            :rules=\"[{ required: true, message: '请选择检查日期' }]\"\r\n          />\r\n          <van-field\r\n            type=\"textarea\"\r\n            rows=\"2\"\r\n            v-model=\"editData.uploadremark\"\r\n            name=\"uploadremark\"\r\n            label=\"问题描述\"\r\n            placeholder=\"问题描述\"\r\n          />\r\n          <upload\r\n            label=\"照片\"\r\n            name=\"uploadurl\"\r\n            :fileList=\"urlList\"\r\n            :rules=\"[{ required: true, message: '请选择照片' }]\"\r\n          ></upload>\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.gongquName\"\r\n            label=\"工区\"\r\n            placeholder=\"工区\"\r\n            @click=\"showGongQu = true\"\r\n            :rules=\"[{ required: true, message: '请选工区' }]\"\r\n          />\r\n          <van-field\r\n            readonly\r\n            clickable\r\n            :value=\"editData.projectName\"\r\n            label=\"单位工程\"\r\n            placeholder=\"单位工程\"\r\n            @click=\"showProject = true\"\r\n            :rules=\"[{ required: true, message: '请选单位工程' }]\"\r\n          />\r\n          <Selecter\r\n            readonly\r\n            clickable\r\n            :value=\"editData.modifyname\"\r\n            label=\"责任人\"\r\n            placeholder=\"责任人\"\r\n            :rules=\"[{ required: true, message: '请选责任人' }]\"\r\n            :actions=\"checkActions\"\r\n            :onSelect=\"onSelectCheck\"\r\n          ></Selecter>\r\n          <van-field\r\n            type=\"digit\"\r\n            v-model=\"editData.modifydate\"\r\n            name=\"modifydate\"\r\n            label=\"整改期限\"\r\n            placeholder=\"整改期限\"\r\n            :rules=\"[{ required: true, message: '请填整改期限' }]\"\r\n          />\r\n\r\n          <div style=\"margin: 4px 16px\">\r\n            <van-button size=\"small\" round block type=\"info\" native-type=\"submit\">提交</van-button>\r\n          </div>\r\n        </van-form>\r\n      </van-tab>\r\n      <van-tab title=\"延期审核\">\r\n        <van-list\r\n          :finished=\"finished\"\r\n          finished-text=\"我也是有底线的~~\"\r\n          @load=\"onLoad\"\r\n          class=\"common-list common-card\"\r\n          :style=\"{ height: scrollerHeight }\"\r\n        >\r\n          <div\r\n            @click=\"itemClick(item, 0)\"\r\n            v-for=\"(item, index) in list\"\r\n            :key=\"index\"\r\n            :class=\"'item ' + (index === list.length - 1 ? 'last' : '')\"\r\n          >\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查时间：</span>\r\n              <span class=\"value\">{{ item.uploadtime }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查人：</span>\r\n              <span class=\"value\">{{ item.uploadname }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">检查备注：</span>\r\n              <span class=\"value\">{{ item.uploadremark }}</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">整改期限：</span>\r\n              <span class=\"value\">{{ item.modifydate }} 天</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">申请延期：</span>\r\n              <span class=\"value\">{{ item.delayday }} 天</span>\r\n            </div>\r\n            <div class=\"content\">\r\n              <span class=\"name\">延期原因：</span>\r\n              <span class=\"value\">{{ item.delayreason }}</span>\r\n            </div>\r\n            <div class=\"operate center-in-vertical\">\r\n              <van-button\r\n                v-if=\"item.delayresult === 1\"\r\n                class=\"button\"\r\n                type=\"primary\"\r\n                size=\"small\"\r\n                @click.stop=\"doDelaySafeEvent(item, 1)\"\r\n                >通过</van-button\r\n              >\r\n              <van-button\r\n                v-if=\"item.delayresult === 1\"\r\n                class=\"button\"\r\n                type=\"danger\"\r\n                size=\"small\"\r\n                @click.stop=\"doDelaySafeEvent(item, 2)\"\r\n                >不通过</van-button\r\n              >\r\n            </div>\r\n          </div>\r\n        </van-list>\r\n      </van-tab>\r\n    </van-tabs>\r\n\r\n    <van-action-sheet v-model=\"showFirst\" :actions=\"firstActions\" @select=\"onSelectFirst\" />\r\n    <van-action-sheet v-model=\"showSecond\" :actions=\"secondActions\" @select=\"onSelectSecond\" />\r\n    <van-action-sheet v-model=\"showGongQu\" :actions=\"gongQuActions\" @select=\"onSelectGongqu\" />\r\n    <van-action-sheet v-model=\"showProject\" :actions=\"projectActions\" @select=\"onSelectProject\" />\r\n    <van-popup v-model=\"showPicker\" position=\"bottom\">\r\n      <van-datetime-picker v-model=\"currentDate\" type=\"datetime\" @confirm=\"onConfirm\" @cancel=\"showPicker = false\" />\r\n    </van-popup>\r\n\r\n    <van-dialog v-model=\"show\" :title=\"title\" show-cancel-button :beforeClose=\"submit\">\r\n      <van-form v-model=\"delayItem\">\r\n        <van-field type=\"textarea\" v-model=\"delayItem.reason\" name=\"uploadremark\" label=\"原因\" placeholder=\"原因\" />\r\n      </van-form>\r\n    </van-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Upload from '@/components/common/Upload'\r\nimport Selecter from '@/components/common/Selecter'\r\nimport {\r\n  getSafeTree,\r\n  getSafeCheck,\r\n  uploadSafeData,\r\n  getGongQuNew,\r\n  getGongQuProject,\r\n  getDelaySafeEvent,\r\n  doDelaySafeEvent\r\n} from '@/api/project.js'\r\nimport { formatISO8601Time } from '@/utils/index'\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  components: {\r\n    Upload,\r\n    Selecter\r\n  },\r\n  data() {\r\n    return {\r\n      editData: {\r\n        safefirstname: '',\r\n        safesecondname: '',\r\n        modifyname: '',\r\n        modifydate: 3\r\n      },\r\n      firstActions: [],\r\n      secondActions: [],\r\n      checkActions: [],\r\n      showFirst: false,\r\n      showSecond: false,\r\n      urlList: [],\r\n      showPicker: false,\r\n      formatISO8601Time,\r\n      gongQuActions: [],\r\n      showGongQu: false,\r\n      projectActions: [],\r\n      showProject: false,\r\n      currentDate: new Date(),\r\n\r\n      list: [],\r\n      finished: false,\r\n      refreshing: false,\r\n      show: false,\r\n      delayItem: { reason: '' },\r\n      title: '通过'\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    scrollerHeight: function() {\r\n      return window.innerHeight - 146 + 'px'\r\n    },\r\n    ...mapGetters(['currentBiaoDuan'])\r\n  },\r\n\r\n  mounted() {},\r\n\r\n  created() {\r\n    let userInfo = JSON.parse(localStorage.getItem('userinfo'))\r\n    this.editData.uploadid = userInfo.id\r\n    this.editData.uploadname = userInfo.name\r\n    this.requestFirst()\r\n    getGongQuNew(this.$store.state.curProject.child[0].id).then(data => {\r\n      this.gongQuActions = data\r\n      data && data.length !== 0 && this.onSelectGongqu(data[0])\r\n    })\r\n  },\r\n\r\n  methods: {\r\n    onSelectFirst(item) {\r\n      this.showFirst = false\r\n      this.editData.safefirstname = item.name\r\n      this.editData.safefirst = item.id\r\n      this.requestSecond(item.id)\r\n    },\r\n    onSelectSecond(item) {\r\n      this.showSecond = false\r\n      this.editData.safesecondname = item.name\r\n      this.editData.safesecond = item.id\r\n    },\r\n    onSelectCheck(item) {\r\n      this.editData.modifyname = item.name\r\n      this.editData.modifyid = item.id\r\n    },\r\n    onSelectGongqu(item) {\r\n      this.showGongQu = false\r\n      this.editData.gongquName = item.name\r\n      this.editData.gongquid = item.sort\r\n\r\n      getGongQuProject({ id: item.sort }).then(data => {\r\n        this.projectActions = data\r\n      })\r\n\r\n      this.requestChecker()\r\n    },\r\n    onSelectProject(item) {\r\n      this.showProject = false\r\n      this.editData.projectName = item.name\r\n      this.editData.singleProjectId = item.id\r\n    },\r\n    onConfirm(time) {\r\n      this.showPicker = false\r\n      this.editData.uploadtime = this.formatISO8601Time(new Date(time).toJSON())\r\n    },\r\n    requestChecker() {\r\n      let that = this\r\n      getSafeCheck({ group: this.editData.gongquid,projectId: this.$store.state.currentBiaoDuan.id }).then(data => {\r\n        that.checkActions = data\r\n        this.onSelectCheck(that.checkActions[0])\r\n      })\r\n    },\r\n    requestFirst() {\r\n      let that = this\r\n      getSafeTree().then(data => {\r\n        that.firstActions = data\r\n        this.onSelectFirst(data[0])\r\n      })\r\n    },\r\n    requestSecond(id) {\r\n      let that = this\r\n      getSafeTree({ id: id }).then(data => {\r\n        that.secondActions = data\r\n        that.editData.safesecondname = data[0].name\r\n        that.editData.safesecond = data[0].id\r\n      })\r\n    },\r\n    onSubmit(values) {\r\n      let data = JSON.parse(JSON.stringify(this.editData))\r\n      data.modifydate = parseInt(data.modifydate)\r\n      data.projectId = this.$store.state.currentBiaoDuan.id\r\n      let temp = []\r\n      values.uploadurl.forEach(item => {\r\n        item.url && temp.push(item.url)\r\n      })\r\n      if(values.uploadurl.length !== temp.length){\r\n         return this.$notify({ type: 'warning', message: '请上传文件或等待文件上传完成！' })\r\n      }\r\n      data.uploadurl = temp.join(',')\r\n      uploadSafeData(data).then(() => {\r\n        this.$notify({\r\n          message: '提交成功！',\r\n          type: 'success'\r\n        })\r\n        this.$router.go(-1)\r\n      })\r\n    },\r\n\r\n    onLoad() {\r\n      let that = this\r\n      getDelaySafeEvent({'projectId':this.currentBiaoDuan.id}).then(data => {\r\n        that.list = data || []\r\n        that.refreshing = false\r\n        this.finished = true\r\n      })\r\n    },\r\n    itemClick(item) {\r\n      this.$router.push({\r\n        name: 'securityDetail',\r\n        params: item\r\n      })\r\n    },\r\n    doDelaySafeEvent(item, result) {\r\n      this.title = result === 1 ? '通过' : '不通过'\r\n      this.show = true\r\n      this.delayItem.result = result\r\n      this.delayItem.eventid = item.id\r\n    },\r\n    submit(action, done) {\r\n      if (action === 'cancel') {\r\n        done()\r\n      } else {\r\n        doDelaySafeEvent(this.delayItem).then(data => {\r\n          this.$toast('处理成功')\r\n          this.$store.dispatch('getRealtimeMessage')\r\n          done()\r\n          this.onLoad()\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}