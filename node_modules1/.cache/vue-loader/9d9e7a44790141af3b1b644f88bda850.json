{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\login\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\login\\index.vue","mtime":1684652788153},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1684411446344},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgY29uc3RhbnRGaWVsZCBmcm9tICdAL2FwaS9ob21lJw0KaW1wb3J0IHsgbG9naW4gfSBmcm9tICdAL2FwaS9wcm9qZWN0LmpzJw0KaW1wb3J0IHsgZ2V0VXNlckluZm8gfSBmcm9tICdAL2FwaS91c2VyYXV0aC5qcycNCmltcG9ydCB7IGFwcFVwZGF0ZSB9IGZyb20gJ0AvdXRpbHMvYXBwVXBkYXRlLmpzJw0KaW1wb3J0IHsgb3ZlcnZpZXdHcm91cHMgfSBmcm9tICdAL2NvbmZpZycNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY29uc3RhbnRGaWVsZCwNCiAgICAgIGxvZ2luRm9ybTogew0KICAgICAgICB1c2VybmFtZTogIiIsDQogICAgICAgIHBhc3N3b3JkOiAiIiwNCiAgICAgICAgY29kZTogIiIsDQogICAgICAgIHV1aWQ6ICIiDQogICAgICB9LA0KICAgICAgYm90dG9tVGl0bGU6IGNvbnN0YW50RmllbGQud2hvbGVOYW1lICsgJy0nICsgY29uc3RhbnRGaWVsZC5uYW1lLA0KICAgICAgYXBwVXBkYXRlLA0KICAgICAgYXBwVHlwZTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9UWVBFLA0KICAgICAgcGFzc3dvcmRUeXBlOiAncGFzc3dvcmQnLA0KICAgICAgc2hvd1B3ZDogZmFsc2UNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5hcHBVcGRhdGUudXBkYXRlKCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZUxvZ2luKCkgew0KICAgICAgY29uc29sZS5sb2coIueZu+W9lS4uLiIpOw0KICAgICAgaWYgKCF0aGlzLmxvZ2luRm9ybS51c2VybmFtZSl7DQogICAgICAgIHJldHVybiB0aGlzLiR0b2FzdC5mYWlsKCfor7fovpPlhaXnlKjmiLflkI0nKTsNCiAgICAgIH0NCiAgICAgIGlmICghdGhpcy5sb2dpbkZvcm0ucGFzc3dvcmQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJHRvYXN0LmZhaWwoJ+ivt+i+k+WFpeWvhueggScpOw0KICAgICAgfQ0KICAgICAgbG9naW4oeyB1c2VybmFtZTogdGhpcy5sb2dpbkZvcm0udXNlcm5hbWUsIHBhc3N3b3JkOiB0aGlzLmxvZ2luRm9ybS5wYXNzd29yZCB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGxldCB1c2VySW5mbyA9IHJlcy51c2VySW5mbzsNCiAgICAgICAgaWYgKHVzZXJJbmZvKSB7DQogICAgICAgICAgaWYgKCF1c2VySW5mby5kZXB0SWQpIHsNCiAgICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoIui0puaIt1siICsgbG9naW5EYXRhLnVzZXJuYW1lICsgIl3mnKrphY3nva7nu4Tnu4fkv6Hmga8s6K+36IGU57O7566h55CG5ZGYIik7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgfQ0KICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyaW5mbycsIEpTT04uc3RyaW5naWZ5KHVzZXJJbmZvKSk7DQogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VwbG9hZE9ubGluZVN0YXRlJykudGhlbigoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ2V0UmVhbHRpbWVPbmxpbmUnKTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIGlmIChvdmVydmlld0dyb3Vwcy5pbmRleE9mKHVzZXJJbmZvLkdST1VQSUQpID49IDApIHsNCiAgICAgICAgICAgIC8vIHRoaXMuJHN0b3JlLnN0YXRlLm92ZXJ2aWV3QXV0aCA9IHRydWUNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdvdmVydmlld0F1dGgnLCB0cnVlKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogJy9wcm9qZWN0T3ZlcnZpZXcnIH0pOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyB0aGlzLiRzdG9yZS5zdGF0ZS5vdmVydmlld0F1dGggPSBmYWxzZQ0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ292ZXJ2aWV3QXV0aCcsIGZhbHNlKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogJy8nIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiR0b2FzdC5mYWlsKCfnmbvlvZXlpLHotKUnKTsNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIG9uU3VibWl0X29sZCh2YWx1ZXMpIHsNCiAgICAgIGxvZ2luKHZhbHVlcykudGhlbihkYXRhID0+IHsNCiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5ncm91cGlkKSB7DQogICAgICAgICAgbGV0IGdyb3VwaWQgPSBkYXRhLmdyb3VwaWQNCiAgICAgICAgICBkYXRhID0gZGF0YS5sb2dpbkRhdGENCiAgICAgICAgICBkYXRhLmdyb3VwaWQgPSBncm91cGlkDQogICAgICAgICAgbGV0IHsgaWQsIG5hbWUsIHRva2VuIH0gPSBkYXRhDQogICAgICAgICAgaWYgKGlkICYmIG5hbWUgJiYgdG9rZW4pIHsNCiAgICAgICAgICAgIHRoaXMudXNlcmF1dGgoaWQpLnRoZW4oKHsgdXNlckF1dGgsIHJvbGVzLCB1c2VySW5mbyB9KSA9PiB7DQogICAgICAgICAgICAgIGRhdGEudXNlckF1dGggPSB1c2VyQXV0aA0KICAgICAgICAgICAgICBkYXRhLnJvbGVzID0gcm9sZXMNCiAgICAgICAgICAgICAgZGF0YS5ncm91cG5hbWUgPSB1c2VySW5mby5HUk9VUE5BTUUNCiAgICAgICAgICAgICAgZGF0YS51c2VyaW5mbyA9IHVzZXJJbmZvDQogICAgICAgICAgICAgIC8vIGlmICh1c2VyQXV0aC5mdW5Db29raWUuaW5kZXhPZihwcm9jZXNzLmVudi5WVUVfQVBQX1RZUEUpID09PSAtMSkgew0KICAgICAgICAgICAgICAvLyAgIHJldHVybiB0aGlzLiR0b2FzdC5mYWlsKCfnlKjmiLfml6DmnYPpmZDov5vlhaXvvIzor7fogZTns7vnrqHnkIblkZjvvIEnKQ0KICAgICAgICAgICAgICAvLyB9DQogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJpbmZvID0gZGF0YQ0KICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5sb2dpbkNvdW50KysNCiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJpbmZvJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpDQoNCiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VwbG9hZE9ubGluZVN0YXRlJykudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dldFJlYWx0aW1lT25saW5lJykNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgaWYgKG92ZXJ2aWV3R3JvdXBzLmluZGV4T2YodXNlckluZm8uR1JPVVBJRCkgPj0gMCkgew0KICAgICAgICAgICAgICAgIC8vIHRoaXMuJHN0b3JlLnN0YXRlLm92ZXJ2aWV3QXV0aCA9IHRydWUNCiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnb3ZlcnZpZXdBdXRoJywgdHJ1ZSkNCiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICcvcHJvamVjdE92ZXJ2aWV3JyB9KQ0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIHRoaXMuJHN0b3JlLnN0YXRlLm92ZXJ2aWV3QXV0aCA9IGZhbHNlDQogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ292ZXJ2aWV3QXV0aCcsIGZhbHNlKQ0KICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogJy8nIH0pDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwodG9rZW4gfHwgJ+eZu+W9leWksei0pScpDQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoZGF0YSA/ICfor6Xop5LoibLmsqHmnInphY3nva7op5LoibLmnYPpmZAs6K+35Yiw6L+Q57u057O757uf6L+b6KGM6YWN572u77yBJyA6ICfotKblj7fmiJblr4bnoIHplJnor6/vvIEnKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgdXNlcmF1dGgoaWQpIHsNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICAgICAgZ2V0VXNlckluZm8oew0KICAgICAgICAgIGlkLA0KICAgICAgICAgIHR5cGU6ICdhcHAnLA0KICAgICAgICAgIHN5c3RlbU5hbWU6ICdwcm9qZWN0Jw0KICAgICAgICB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICAgIHJlc29sdmUoZGF0YSkNCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBzd2l0Y2hQYXNzd29yZFR5cGUoKSB7DQogICAgICB0aGlzLnBhc3N3b3JkVHlwZSA9IHRoaXMucGFzc3dvcmRUeXBlID09PSAncGFzc3dvcmQnID8gJ3RleHQnIDogJ3Bhc3N3b3JkJw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"bg\">\r\n      <div class=\"title\">{{ constantField.wholeName }}</div>\r\n      <div class=\"card\">\r\n        <div class=\"title\">登录</div>\r\n\r\n          <van-field\r\n            v-model=\"loginForm.username\"\r\n            name=\"username\"\r\n            placeholder=\"用户名\"\r\n            :rules=\"[{ required: true, message: '请填写用户名' }]\"\r\n            size=\"large\"\r\n          />\r\n          <van-field\r\n            v-model=\"loginForm.password\"\r\n            :type=\"passwordType\"\r\n            name=\"password\"\r\n            placeholder=\"密码\"\r\n            :rules=\"[{ required: true, message: '请填写密码' }]\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <template slot=\"right-icon\">\r\n              <van-switch v-model=\"showPwd\" @change=\"switchPasswordType\" />\r\n            </template>\r\n          </van-field>\r\n\r\n          <el-button\r\n            type=\"primary\"\r\n            style=\"width: 100%; margin-top: 26px;font-size: 18px; font-weight: 400;\" @click=\"handleLogin\"\r\n            >登录\r\n          </el-button\r\n      >\r\n        </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport constantField from '@/api/home'\r\nimport { login } from '@/api/project.js'\r\nimport { getUserInfo } from '@/api/userauth.js'\r\nimport { appUpdate } from '@/utils/appUpdate.js'\r\nimport { overviewGroups } from '@/config'\r\nexport default {\r\n  data() {\r\n    return {\r\n      constantField,\r\n      loginForm: {\r\n        username: \"\",\r\n        password: \"\",\r\n        code: \"\",\r\n        uuid: \"\"\r\n      },\r\n      bottomTitle: constantField.wholeName + '-' + constantField.name,\r\n      appUpdate,\r\n      appType: process.env.VUE_APP_TYPE,\r\n      passwordType: 'password',\r\n      showPwd: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.appUpdate.update()\r\n  },\r\n  methods: {\r\n    handleLogin() {\r\n      console.log(\"登录...\");\r\n      if (!this.loginForm.username){\r\n        return this.$toast.fail('请输入用户名');\r\n      }\r\n      if (!this.loginForm.password) {\r\n        return this.$toast.fail('请输入密码');\r\n      }\r\n      login({ username: this.loginForm.username, password: this.loginForm.password }).then(res => {\r\n        let userInfo = res.userInfo;\r\n        if (userInfo) {\r\n          if (!userInfo.deptId) {\r\n            this.$toast.fail(\"账户[\" + loginData.username + \"]未配置组织信息,请联系管理员\");\r\n            return false;\r\n          }\r\n          localStorage.setItem('userinfo', JSON.stringify(userInfo));\r\n          this.$store.dispatch('uploadOnlineState').then(() => {\r\n            this.$store.dispatch('getRealtimeOnline');\r\n          })\r\n          if (overviewGroups.indexOf(userInfo.GROUPID) >= 0) {\r\n            // this.$store.state.overviewAuth = true\r\n            localStorage.setItem('overviewAuth', true);\r\n            this.$router.push({ path: '/projectOverview' });\r\n          } else {\r\n            // this.$store.state.overviewAuth = false\r\n            localStorage.setItem('overviewAuth', false);\r\n            this.$router.push({ path: '/' });\r\n          }\r\n        } else {\r\n          this.$toast.fail('登录失败');\r\n        }\r\n      })\r\n    },\r\n    onSubmit_old(values) {\r\n      login(values).then(data => {\r\n        if (data && data.groupid) {\r\n          let groupid = data.groupid\r\n          data = data.loginData\r\n          data.groupid = groupid\r\n          let { id, name, token } = data\r\n          if (id && name && token) {\r\n            this.userauth(id).then(({ userAuth, roles, userInfo }) => {\r\n              data.userAuth = userAuth\r\n              data.roles = roles\r\n              data.groupname = userInfo.GROUPNAME\r\n              data.userinfo = userInfo\r\n              // if (userAuth.funCookie.indexOf(process.env.VUE_APP_TYPE) === -1) {\r\n              //   return this.$toast.fail('用户无权限进入，请联系管理员！')\r\n              // }\r\n              this.$store.state.userinfo = data\r\n              this.$store.state.loginCount++\r\n              localStorage.setItem('userinfo', JSON.stringify(data))\r\n\r\n              this.$store.dispatch('uploadOnlineState').then(() => {\r\n                this.$store.dispatch('getRealtimeOnline')\r\n              })\r\n              if (overviewGroups.indexOf(userInfo.GROUPID) >= 0) {\r\n                // this.$store.state.overviewAuth = true\r\n                localStorage.setItem('overviewAuth', true)\r\n                this.$router.push({ path: '/projectOverview' })\r\n              } else {\r\n                // this.$store.state.overviewAuth = false\r\n                localStorage.setItem('overviewAuth', false)\r\n                this.$router.push({ path: '/' })\r\n              }\r\n            })\r\n          } else {\r\n            this.$toast.fail(token || '登录失败')\r\n          }\r\n        } else {\r\n          this.$toast.fail(data ? '该角色没有配置角色权限,请到运维系统进行配置！' : '账号或密码错误！')\r\n        }\r\n      })\r\n    },\r\n    userauth(id) {\r\n      return new Promise(resolve => {\r\n        getUserInfo({\r\n          id,\r\n          type: 'app',\r\n          systemName: 'project'\r\n        }).then(data => {\r\n          resolve(data)\r\n        })\r\n      })\r\n    },\r\n    switchPasswordType() {\r\n      this.passwordType = this.passwordType === 'password' ? 'text' : 'password'\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.login-container {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: url(../../assets/image/bg_login.png) no-repeat;\r\n  background-size: 100% 100%;\r\n  .bg {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    .title {\r\n      width: 100%;\r\n      height: 44px;\r\n      font-size: 19px;\r\n      margin-top: 25px;\r\n      text-align: center;\r\n      font-family: SFPro-Semibold, SFPro;\r\n      font-weight: 600;\r\n      color: #fff;\r\n      line-height: 44px;\r\n    }\r\n    .card {\r\n      margin: 80px 40px 0px;\r\n      overflow:hidden;\r\n      .title {\r\n        text-align: initial;\r\n        height: 35px;\r\n        margin-top: 0px;\r\n        font-size: 25px;\r\n      }\r\n      ::v-deep .van-field {\r\n        margin-top: 22px;\r\n        height: 45px;\r\n        border-radius: 3px;\r\n        padding: initial;\r\n        padding-left: 10px;\r\n        .van-cell__value {\r\n          height: 100%;\r\n          .van-field__body {\r\n            height: 100% !important;\r\n\r\n            .van-field__control {\r\n              height: 100%;\r\n              background-color: transparent;\r\n            }\r\n            .van-field__right-icon {\r\n              margin-right: 0px;\r\n              display: flex;\r\n              .van-switch {\r\n                background: rgba(120, 120, 128, 0.32);\r\n                width: 1.8em;\r\n                border: 0px;\r\n                .van-switch__node {\r\n                  top: 0.1em;\r\n                  left: 0.1em;\r\n                  width: 0.8em;\r\n                  height: 0.8em;\r\n                }\r\n              }\r\n              .van-switch--on {\r\n                background-color: #1989fa;\r\n                .van-switch__node {\r\n                  -webkit-transform: translateX(0.8em);\r\n                  transform: translateX(0.8em);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .van-button {\r\n        margin-top: 40px;\r\n        border-radius: 3px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}