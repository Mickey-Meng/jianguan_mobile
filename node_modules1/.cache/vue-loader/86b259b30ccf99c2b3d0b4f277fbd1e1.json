{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\qualityAndSafetyOverview.vue?vue&type=style&index=0&id=d94aa11a&lang=scss&scoped=true&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\qualityAndSafetyOverview.vue","mtime":1684246187886},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1684411443176},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1684411446724},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1684411443221},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1684411446938},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoub3ZlcnZpZXcgew0KICBtYXJnaW46IDEycHggMDsNCiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgcGFkZGluZy10b3A6IDEwcHg7DQogIC5zcGFuLWNvbnRhaW5lciB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICRhY3RpdmUtY29sb3I7DQogICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgIGhlaWdodDogMjZweDsNCiAgICBsaW5lLWhlaWdodDogMjZweDsNCiAgICBzcGFuIHsNCiAgICAgIGZsb2F0OiBsZWZ0Ow0KICAgICAgbWFyZ2luLWxlZnQ6IDEwcHg7DQogICAgfQ0KICB9DQogIC5vdmVydmlld1R5cGUgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbi1sZWZ0OiAxMHB4Ow0KICAgIHdpZHRoOiAxMjBweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAkYWN0aXZlLWNvbG9yOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXI6IG5vbmU7DQogIH0NCiAgLnNwYW4tY29udGFpbmVyOjphZnRlciB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHRvcDogNTAlOw0KICAgIHJpZ2h0OiAxMHB4Ow0KICAgIG1hcmdpbi10b3A6IC01cHg7DQogICAgYm9yZGVyOiAzcHggc29saWQ7DQogICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudCB0cmFuc3BhcmVudCAjZGNkZWUwICNkY2RlZTA7DQogICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpOw0KICAgIHRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7DQogICAgb3BhY2l0eTogMC44Ow0KICAgIGNvbnRlbnQ6ICcnOw0KICB9DQp9DQouZWNoYXJ0IHsNCiAgLmNpcmNsZSB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxNjBweDsNCiAgfQ0KICAuZWNoYXJ0LWluZm8gew0KICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICBwYWRkaW5nOiA1cHggMTBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICAmLnRvdGFsIHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNlYmYzZmU7DQogICAgICBjb2xvcjogIzM2ODlmNDsNCiAgICB9DQogICAgJi5maW5pc2ggew0KICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZjhmMDsNCiAgICAgIGNvbG9yOiAjNjdjMzc3Ow0KICAgIH0NCiAgICAmLnVuZmluaXNoIHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZWVmZWE7DQogICAgICBjb2xvcjogI2Y2NWMzNjsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["qualityAndSafetyOverview.vue"],"names":[],"mappings":";AA4NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"qualityAndSafetyOverview.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"overview\">\r\n    <van-row>\r\n      <van-col span=\"12\">\r\n        <div class=\"span-container overviewType\" @click=\"showOverviewType = true\">\r\n          <span>\r\n            {{ this.overviewType }}\r\n          </span>\r\n        </div>\r\n      </van-col>\r\n      <van-col span=\"12\">\r\n        <van-radio-group v-model=\"count\" direction=\"horizontal\" @change=\"countChange\">\r\n          <van-radio :name=\"1\">近一个月</van-radio>\r\n          <van-radio :name=\"3\">近三个月</van-radio>\r\n        </van-radio-group>\r\n      </van-col>\r\n    </van-row>\r\n    <van-row class=\"echart\" v-if=\"showChart\">\r\n      <van-col span=\"12\" @click=\"toQulityList\" v-if=\"overviewType == '质量总览'\"\r\n        ><common-chart :options=\"qualityOptions\" className=\"circle\"></common-chart\r\n      ></van-col>\r\n      <van-col span=\"12\" @click=\"toSafetyList\" v-else\r\n        ><common-chart :options=\"safetyOptions\" className=\"circle\"></common-chart\r\n      ></van-col>\r\n      <van-col span=\"12\" style=\"padding-top: 26px; padding-right: 20px\">\r\n        <div class=\"echart-info total\">\r\n          <span>提出整改</span><span>{{ total }}起</span>\r\n        </div>\r\n        <div class=\"echart-info finish\">\r\n          <span>完成整改</span><span>{{ finish }}起</span>\r\n        </div>\r\n        <div class=\"echart-info unfinish\">\r\n          <span>已逾期</span><span>{{ unfinish }}起</span>\r\n        </div>\r\n      </van-col>\r\n    </van-row>\r\n    <van-action-sheet v-model=\"showOverviewType\" :actions=\"overviewTypes\" @select=\"overviewTypeChange\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport { newInterfaceQuality, newInterfaceSafety } from '@/api/project'\r\nimport CommonChart from '@/components/echarts/CommonChart'\r\nexport default {\r\n  components: {\r\n    CommonChart\r\n  },\r\n  computed: {\r\n    ...mapGetters(['currentBiaoDuan'])\r\n  },\r\n  watch: {\r\n    currentBiaoDuan: function(value) {\r\n      this.getData()\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      // key: value\r\n      count: 3,\r\n      showChart: false,\r\n      overviewType: '安全总览',\r\n      overviewTypes: [{ name: '安全总览' }, { name: '质量总览' }],\r\n      showOverviewType: false,\r\n      qualityData: [\r\n        { value: 0, name: '完成整改' },\r\n        { value: 0, name: '已逾期' }\r\n      ],\r\n      safetyData: [\r\n        { value: 0, name: '提出整改' },\r\n        { value: 0, name: '完成整改' }\r\n      ],\r\n      qualityOptions: {},\r\n      safetyOptions: {},\r\n\r\n      total: 0,\r\n      finish: 0,\r\n      unfinish: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    getData() {\r\n      if (this.overviewType == '质量总览') {\r\n        newInterfaceQuality({ count: this.count, projectId: this.currentBiaoDuan.id }).then(res => {\r\n          this.total = 0\r\n          this.finish = 0\r\n          this.unfinish = 0\r\n          res?.total?.forEach(item => {\r\n            this.total += parseInt(item.count)\r\n            this.finish += parseInt(item.finish)\r\n          })\r\n          res?.overdueList?.forEach(item => {\r\n            this.unfinish += parseInt(item.overdue)\r\n          })\r\n          this.qualityData = [\r\n            { value: this.total === 0 ? 0 : ((this.finish / this.total) * 100).toFixed(2), name: '完成整改' },\r\n            {\r\n              value: this.total === 0 ? 0 : ((this.unfinish / this.total) * 100).toFixed(2),\r\n              name: '已逾期'\r\n            }\r\n          ]\r\n          this.drawChart()\r\n        })\r\n      } else {\r\n        newInterfaceSafety({ count: this.count, projectId: this.currentBiaoDuan.id }).then(res => {\r\n          this.total = 0\r\n          this.finish = 0\r\n          this.unfinish = 0\r\n          res?.total?.forEach(item => {\r\n            this.total += parseInt(item.count)\r\n            this.finish += parseInt(item.finish)\r\n          })\r\n          res?.overdueList?.forEach(item => {\r\n            this.unfinish += parseInt(item.overdue)\r\n          })\r\n          this.safetyData = [\r\n            { value: this.total === 0 ? 0 : ((this.finish / this.total) * 100).toFixed(2), name: '完成整改' },\r\n            {\r\n              value: this.total === 0 ? 0 : ((this.unfinish / this.total) * 100).toFixed(2),\r\n              name: '已逾期'\r\n            }\r\n          ]\r\n          this.drawChart()\r\n        })\r\n      }\r\n    },\r\n    drawChart() {\r\n      this.showChart = false\r\n      this.qualityOptions = this.getOptions('质量总览', this.qualityData)\r\n      this.safetyOptions = this.getOptions('安全总览', this.safetyData)\r\n      this.$nextTick(() => {\r\n        this.showChart = true\r\n      })\r\n    },\r\n    getOptions(title, data) {\r\n      return {\r\n        graphic: [\r\n          {\r\n            type: 'text',\r\n            left: '40%',\r\n            top: '40%',\r\n            z: 10,\r\n            style: {\r\n              fill: '#388BF5',\r\n              text: data[0].value + '%',\r\n              font: 'bolder 14px Microsoft YaHei'\r\n            },\r\n            formatter: '进度：{d}%'\r\n          },\r\n          {\r\n            type: 'text',\r\n            left: '35%',\r\n            top: '55%',\r\n            z: 10,\r\n            style: {\r\n              fill: '#000',\r\n              text: '整改完成率',\r\n              font: '13px Microsoft YaHei'\r\n            },\r\n            formatter: '进度：{d}%'\r\n          }\r\n        ],\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: '进度：{d}%',\r\n          backgroundColor: 'rgba(255,255,255,0.8)'\r\n        },\r\n        // title: {\r\n        //   text: title,\r\n        //   x: 'center',\r\n        //   y: 'bottom',\r\n        //   padding: [0, 0, 20, 0],\r\n        //   textStyle: {\r\n        //     fontSize: 15\r\n        //   }\r\n        // },\r\n        color: ['#388BF5', '#F0F0F0'],\r\n        series: [\r\n          {\r\n            name: title,\r\n            type: 'pie',\r\n            radius: ['55%', '65%'],\r\n            center: ['50%', '50%'],\r\n            itemStyle: {\r\n              normal: {\r\n                label: {\r\n                  show: false\r\n                },\r\n                labelLine: {\r\n                  show: false\r\n                }\r\n              }\r\n            },\r\n            data: data\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    countChange() {\r\n      this.getData()\r\n    },\r\n    toQulityList() {\r\n      this.$router.push({ path: '/record' })\r\n    },\r\n    toSafetyList() {\r\n      this.$router.push({ path: '/securityRecord' })\r\n    },\r\n    overviewTypeChange(item) {\r\n      this.showOverviewType = false\r\n      this.overviewType = item.name\r\n      this.getData()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.overview {\r\n  margin: 12px 0;\r\n  background-color: white;\r\n  border-radius: 6px;\r\n  padding-top: 10px;\r\n  .span-container {\r\n    position: relative;\r\n    border: 1px solid $active-color;\r\n    border-radius: 5px;\r\n    height: 26px;\r\n    line-height: 26px;\r\n    span {\r\n      float: left;\r\n      margin-left: 10px;\r\n    }\r\n  }\r\n  .overviewType {\r\n    float: left;\r\n    margin-left: 10px;\r\n    width: 120px;\r\n    background-color: $active-color;\r\n    color: white;\r\n    border: none;\r\n  }\r\n  .span-container::after {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: 10px;\r\n    margin-top: -5px;\r\n    border: 3px solid;\r\n    border-color: transparent transparent #dcdee0 #dcdee0;\r\n    -webkit-transform: rotate(-45deg);\r\n    transform: rotate(-45deg);\r\n    opacity: 0.8;\r\n    content: '';\r\n  }\r\n}\r\n.echart {\r\n  .circle {\r\n    width: 100%;\r\n    height: 160px;\r\n  }\r\n  .echart-info {\r\n    margin-top: 8px;\r\n    padding: 5px 10px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    &.total {\r\n      background-color: #ebf3fe;\r\n      color: #3689f4;\r\n    }\r\n    &.finish {\r\n      background-color: #eef8f0;\r\n      color: #67c377;\r\n    }\r\n    &.unfinish {\r\n      background-color: #feefea;\r\n      color: #f65c36;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}