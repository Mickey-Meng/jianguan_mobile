{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\Overview.vue?vue&type=style&index=0&id=6408adae&lang=scss&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\Overview.vue","mtime":1684246187877},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1684411443176},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1684411446724},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1684411443221},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1684411446938},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoub3ZlcnZpZXcgew0KICBtYXJnaW46IDEycHggMDsNCiAgLmNvbmRpdGlvbiB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogICAgbWFyZ2luOiAycHggMDsNCiAgICBoZWlnaHQ6IDM4cHg7DQogICAgbGluZS1oZWlnaHQ6IDM4cHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICAuc3Bhbi1jb250YWluZXIsDQogICAgLnR5cGUtY29udGFpbmVyIHsNCiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICRhY3RpdmUtY29sb3I7DQogICAgICBib3JkZXItcmFkaXVzOiA1cHg7DQogICAgICBoZWlnaHQ6IDI2cHg7DQogICAgICBsaW5lLWhlaWdodDogMjZweDsNCiAgICAgIG1hcmdpbi10b3A6IDZweDsNCiAgICAgIGZsb2F0OiBsZWZ0Ow0KICAgICAgbWFyZ2luLWxlZnQ6IDEwcHg7DQogICAgICB3aWR0aDogMTIwcHg7DQogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAkYWN0aXZlLWNvbG9yOw0KICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgc3BhbiB7DQogICAgICAgIGZsb2F0OiBsZWZ0Ow0KICAgICAgICBtYXJnaW4tbGVmdDogMTBweDsNCiAgICAgIH0NCiAgICB9DQogICAgLnR5cGUtY29udGFpbmVyIHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICAgICAgY29sb3I6IGJsYWNrOw0KICAgICAgZmxvYXQ6IHJpZ2h0Ow0KICAgICAgd2lkdGg6IDE4MHB4Ow0KICAgICAgYm9yZGVyOiAxcHggc29saWQgJGFjdGl2ZS1jb2xvcjsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgIG1hcmdpbi1yaWdodDogMTBweDsNCiAgICB9DQogICAgLnR5cGUtY29udGFpbmVyOjphZnRlciB7DQogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICB0b3A6IDUwJTsNCiAgICAgIHJpZ2h0OiAxMHB4Ow0KICAgICAgbWFyZ2luLXRvcDogLTVweDsNCiAgICAgIGJvcmRlcjogM3B4IHNvbGlkOw0KICAgICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudCB0cmFuc3BhcmVudCAjZGNkZWUwICNkY2RlZTA7DQogICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7DQogICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpOw0KICAgICAgb3BhY2l0eTogMC44Ow0KICAgICAgY29udGVudDogJyc7DQogICAgfQ0KICB9DQogIC5jb250ZW50LWNoYXJ0IHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgbWFyZ2luOiAxMnB4IDA7DQogIH0NCiAgLmNvbnRlbnQgew0KICAgIC52YWx1ZSB7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICBmb250LXNpemU6IDMwcHg7DQogICAgICBtYXJnaW46IDEwcHggMCAwIDA7DQogICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgIGZvbnQtZmFtaWx5OiAndGltZScsIHNlcmlmOw0KICAgIH0NCiAgICAubmFtZSB7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICBtYXJnaW46IDAgMCAxMHB4IDA7DQogICAgICBmb250LXNpemU6IDEwcHg7DQogICAgfQ0KICB9DQogIC5lY2hhcnQgew0KICAgIC5jaXJjbGUgew0KICAgICAgd2lkdGg6IDEwMCU7DQogICAgICBoZWlnaHQ6IDIwMHB4Ow0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["Overview.vue"],"names":[],"mappings":";AA8NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Overview.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"overview\">\r\n    <div class=\"content-chart\">\r\n      <van-row class=\"content\" v-show=\"showMiddleData\">\r\n        <van-col span=\"6\" v-for=\"(item, index) in data\" :key=\"index\">\r\n          <div class=\"value\" :style=\"{ color: item.color }\">{{ isNotG235() ? 0 : item.value }}</div>\r\n          <div class=\"name\">{{ item.name }}</div>\r\n        </van-col>\r\n      </van-row>\r\n      <van-row class=\"echart\" v-if=\"showChart\" @click=\"toReport\">\r\n        <van-col span=\"12\"><common-chart :options=\"leftOptions\" className=\"circle\"></common-chart></van-col>\r\n        <van-col span=\"12\"><common-chart :options=\"rightOptions\" className=\"circle\"></common-chart></van-col>\r\n      </van-row>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport constantField from '@/api/home'\r\nimport CommonChart from '@/components/echarts/CommonChart'\r\nimport { getMiddleData, getFinishConponent } from '@/api/project.js'\r\nexport default {\r\n  components: {\r\n    CommonChart\r\n  },\r\n  data() {\r\n    return {\r\n      data: [\r\n        {\r\n          name: '构件总数量',\r\n          value: 0,\r\n          color: '#1989fa'\r\n        },\r\n        {\r\n          name: '已完成数量',\r\n          value: 0,\r\n          color: '#07c160'\r\n        },\r\n        {\r\n          name: '延期数量',\r\n          value: 0,\r\n          color: '#ee0a24'\r\n        },\r\n        {\r\n          name: '当天完成数量',\r\n          value: 0,\r\n          color: '#1989fa'\r\n        }\r\n      ],\r\n      leftData: [\r\n        { value: 40, name: '已完成' },\r\n        { value: 60, name: '未完成' }\r\n      ],\r\n      rightData: [\r\n        { value: 50, name: '已完成' },\r\n        { value: 50, name: '未完成' }\r\n      ],\r\n      leftOptions: {},\r\n      rightOptions: {},\r\n      showChart: false,\r\n      showMiddleData: false,\r\n      isRequest: false,\r\n      projectTypes: constantField.projectTypes,\r\n      projectType: ''\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['currentProject', 'currentBiaoDuan', 'curProject'])\r\n  },\r\n  watch: {\r\n    projectType: function(value) {\r\n      let project = constantField.projectTypes.find(item => item.value === value)\r\n      this.$store.state.currentProject = project\r\n    },\r\n    currentProject: function(value) {\r\n      this.getCurrentMiddleData(value)\r\n      this.getCurrentFinishConponent(value)\r\n    },\r\n    currentBiaoDuan: function() {\r\n      this.init()\r\n      this.getCurrentMiddleData(this.currentProject)\r\n      this.getCurrentFinishConponent(this.currentProject)\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init()\r\n    this.getCurrentMiddleData(this.currentProject)\r\n    this.getCurrentFinishConponent(this.currentProject)\r\n  },\r\n  methods: {\r\n    isNotG235() {\r\n      return this.curProject?.id !== 2\r\n    },\r\n    init() {\r\n      this.projectType = this.projectTypes[0].value\r\n    },\r\n    getCurrentFinishConponent(currentProject) {\r\n      getFinishConponent({ type: currentProject.value }).then(data => {\r\n        this.leftData = [\r\n          {\r\n            value: this.isNotG235()\r\n              ? 0\r\n              : data.act.count === 0\r\n              ? 0\r\n              : ((data.act.finish / data.act.count) * 100).toFixed(2),\r\n            name: '已完成'\r\n          },\r\n          {\r\n            value: this.isNotG235()\r\n              ? 0\r\n              : data.act.count === 0\r\n              ? 0\r\n              : (((data.act.count - data.act.finish) / data.act.count) * 100).toFixed(2),\r\n            name: '未完成'\r\n          }\r\n        ]\r\n\r\n        this.rightData = [\r\n          {\r\n            value: this.isNotG235()\r\n              ? 0\r\n              : data.plan.count === 0\r\n              ? 0\r\n              : ((data.plan.finish / data.plan.count) * 100).toFixed(2),\r\n            name: '已完成'\r\n          },\r\n          {\r\n            value: this.isNotG235()\r\n              ? 0\r\n              : data.plan.count === 0\r\n              ? 0\r\n              : (((data.plan.count - data.plan.finish) / data.plan.count) * 100).toFixed(2),\r\n            name: '未完成'\r\n          }\r\n        ]\r\n\r\n        this.drawChart()\r\n      })\r\n    },\r\n    getCurrentMiddleData(currentProject) {\r\n      this.isRequest = true\r\n      getMiddleData({ projectId: this.$store.state.currentBiaoDuan.id }).then(data => {\r\n        let item = data[currentProject.value]\r\n        this.data[0].value = item ? item.count : 0\r\n        this.data[1].value = item ? item.finish : 0\r\n        this.data[2].value = item ? item.dalay : 0\r\n        this.data[3].value = item ? item.todayFinish : 0\r\n        this.showMiddleData = true\r\n        this.isRequest = false\r\n      })\r\n    },\r\n    typeChange(item) {\r\n      this.type = item.name\r\n      this.show = false\r\n      this.drawChart()\r\n    },\r\n    drawChart() {\r\n      this.showChart = false\r\n      this.leftOptions = this.getOptions('形象完成量', this.leftData)\r\n      this.rightOptions = this.getOptions('计划完成量', this.rightData)\r\n      this.$nextTick(() => {\r\n        this.showChart = true\r\n      })\r\n    },\r\n    getOptions(title, data) {\r\n      return {\r\n        graphic: [\r\n          {\r\n            type: 'text',\r\n            left: '40%',\r\n            top: '37%',\r\n            z: 10,\r\n            style: {\r\n              fill: '#6f9426',\r\n              text: data[0].value + '%',\r\n              font: '14px Microsoft YaHei'\r\n            },\r\n            formatter: '进度：{d}%'\r\n          }\r\n        ],\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: '进度：{d}%',\r\n          backgroundColor: 'rgba(255,255,255,0.8)'\r\n        },\r\n        title: {\r\n          text: title,\r\n          x: 'center',\r\n          y: 'bottom',\r\n          padding: [0, 0, 20, 0],\r\n          textStyle: {\r\n            fontSize: 15\r\n          }\r\n        },\r\n        series: [\r\n          {\r\n            name: title,\r\n            type: 'pie',\r\n            radius: ['38.5%', '49%'],\r\n            center: ['50%', '40%'],\r\n            itemStyle: {\r\n              normal: {\r\n                label: {\r\n                  show: false\r\n                },\r\n                labelLine: {\r\n                  show: false\r\n                }\r\n              }\r\n            },\r\n            data: data\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    toReport() {\r\n      this.$router.push({ name: 'report' })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.overview {\r\n  margin: 12px 0;\r\n  .condition {\r\n    background-color: white;\r\n    margin: 2px 0;\r\n    height: 38px;\r\n    line-height: 38px;\r\n    text-align: center;\r\n    font-size: 14px;\r\n    width: 100%;\r\n    .span-container,\r\n    .type-container {\r\n      position: relative;\r\n      border: 1px solid $active-color;\r\n      border-radius: 5px;\r\n      height: 26px;\r\n      line-height: 26px;\r\n      margin-top: 6px;\r\n      float: left;\r\n      margin-left: 10px;\r\n      width: 120px;\r\n      background-color: $active-color;\r\n      color: white;\r\n      border: none;\r\n      span {\r\n        float: left;\r\n        margin-left: 10px;\r\n      }\r\n    }\r\n    .type-container {\r\n      background-color: transparent;\r\n      color: black;\r\n      float: right;\r\n      width: 180px;\r\n      border: 1px solid $active-color;\r\n      border-radius: 5px;\r\n      margin-right: 10px;\r\n    }\r\n    .type-container::after {\r\n      position: absolute;\r\n      top: 50%;\r\n      right: 10px;\r\n      margin-top: -5px;\r\n      border: 3px solid;\r\n      border-color: transparent transparent #dcdee0 #dcdee0;\r\n      -webkit-transform: rotate(-45deg);\r\n      transform: rotate(-45deg);\r\n      opacity: 0.8;\r\n      content: '';\r\n    }\r\n  }\r\n  .content-chart {\r\n    background-color: white;\r\n    border-radius: 6px;\r\n    margin: 12px 0;\r\n  }\r\n  .content {\r\n    .value {\r\n      text-align: center;\r\n      font-size: 30px;\r\n      margin: 10px 0 0 0;\r\n      font-weight: bold;\r\n      font-family: 'time', serif;\r\n    }\r\n    .name {\r\n      text-align: center;\r\n      margin: 0 0 10px 0;\r\n      font-size: 10px;\r\n    }\r\n  }\r\n  .echart {\r\n    .circle {\r\n      width: 100%;\r\n      height: 200px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}