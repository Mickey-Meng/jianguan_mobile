{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\contract\\clockInAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\project\\contract\\clockInAdd.vue","mtime":1684246187997},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1684411446344},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyByZWYgfSBmcm9tICd2dWUnDQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCcNCmltcG9ydCB7IGdldE5vd0RhdGUgfSBmcm9tICdAL3V0aWxzL2RhdGUuanMnDQppbXBvcnQgeyBsb2NhdGlvblV0aWwgfSBmcm9tICdAL3V0aWxzL2xvY2F0aW9uVXRpbC5qcycNCmltcG9ydCBVcGxvYWQgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9VcGxvYWQnDQppbXBvcnQgTGVhZkxldE1hcCBmcm9tICdAL2NvbXBvbmVudHMvbWFwL0xlYWZMZXRNYXAudnVlJw0KaW1wb3J0IHsgZ2V0RmVuY2UsIHN1YkNsb2NrSW4gfSBmcm9tICdAL2FwaS9wcm9qZWN0Jw0KaW1wb3J0IHsgZm9ybWF0SW1nVXJsIH0gZnJvbSAnQC91dGlscy9pbmRleCcNCmltcG9ydCAqIGFzIHR1cmYgZnJvbSAnQHR1cmYvdHVyZicNCmltcG9ydCB7IHJldmVyc2VfZ2VvY29kaW5nIH0gZnJvbSAnQC9hcGkvYmRNYXAuanMnDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHsNCiAgICBVcGxvYWQsDQogICAgTGVhZkxldE1hcA0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWyd1c2VyaW5mbycsICdjdXJyZW50Qmlhb0R1YW4nXSksDQogICAgc2Nyb2xsZXJIZWlnaHQ6IGZ1bmN0aW9uKCkgew0KICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodCAtIDg1ICsgJ3B4Jw0KICAgIH0NCiAgfSwNCg0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBwaWNGaWxlZDogJ2Nsb2NrUGljJywNCiAgICAgIGNsb2NrRGF0YToge30sDQogICAgICBzaG93VGltZTogJycsDQogICAgICBzaG93RW5kVGltZTogJycsDQogICAgICBjdXJMb2NhdGlvbjogW10sDQogICAgICBjdXJQb2x5Z29uQ29vcjogW10sDQogICAgICBmZW5jZXM6IFtdLA0KICAgICAgYWRkOiB0cnVlLA0KICAgICAgZkxpc3Q6IFtdLA0KICAgICAgLy8gZkVuZExpc3Q6IFtdLA0KICAgICAgZm9ybWF0SW1nVXJsLA0KICAgICAgbGFzdExvY2F0aW9uTWFya2VyOiBudWxsDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLiRyb3V0ZS5wYXJhbXMpICE9ICd7fScpIHsNCiAgICAgIHRoaXMuZkxpc3QgPSB0aGlzLmZvcm1hdEltZ1VybCh0aGlzLiRyb3V0ZS5wYXJhbXMuY2xvY2tQaWMpDQogICAgICAvLyB0aGlzLmZFbmRMaXN0ID0gdGhpcy5mb3JtYXRJbWdVcmwodGhpcy4kcm91dGUucGFyYW1zLmNsb2NrRW5kUGljKQ0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBpZiAoSlNPTi5zdHJpbmdpZnkodGhpcy4kcm91dGUucGFyYW1zKSAhPSAne30nKSB7DQogICAgICB0aGlzLmFkZCA9IGZhbHNlDQogICAgICB0aGlzLmNsb2NrRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuJHJvdXRlLnBhcmFtcykNCiAgICAgIHRoaXMuc2hvd1RpbWUgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuY2xvY2tUaW1lDQogICAgICAgID8gdGhpcy4kcm91dGUucGFyYW1zLmNsb2NrVGltZS5zdWJzdHJpbmcoMCwgMTkpLnJlcGxhY2UoJ1QnLCAnICcpDQogICAgICAgIDogJycNCiAgICAgIC8vIHRoaXMuc2hvd0VuZFRpbWUgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuY2xvY2tFbmRUaW1lDQogICAgICAvLyAgID8gdGhpcy4kcm91dGUucGFyYW1zLmNsb2NrRW5kVGltZS5zdWJzdHJpbmcoMCwgMTkpLnJlcGxhY2UoJ1QnLCAnICcpDQogICAgICAvLyAgIDogJycNCiAgICAgIHRoaXMubWFwRWNobygpDQogICAgfSBlbHNlIHsNCiAgICAgIHRoaXMuYWRkID0gdHJ1ZQ0KICAgICAgdGhpcy5zaG93VGltZSA9IGdldE5vd0RhdGUoKQ0KICAgICAgbGV0IG5vd1RpbWUgPSB0aGlzLm1vbWVudCgpDQogICAgICAgIC51dGMoKQ0KICAgICAgICAudG9JU09TdHJpbmcoKQ0KICAgICAgdGhpcy4kc2V0KHRoaXMuY2xvY2tEYXRhLCAnY2xvY2tUaW1lJywgbm93VGltZSkNCiAgICAgIHRoaXMuJHNldCh0aGlzLmNsb2NrRGF0YSwgJ2F0dGVuZGFuY2VQZXJzb25JZCcsIHRoaXMudXNlcmluZm8uaWQpDQogICAgICB0aGlzLiRzZXQodGhpcy5jbG9ja0RhdGEsICdhdHRlbmRhbmNlUGVyc29uTmFtZScsIHRoaXMudXNlcmluZm8ubmFtZSkNCiAgICAgIHRoaXMuJHNldCh0aGlzLmNsb2NrRGF0YSwgJ2dyb3VwSWQnLCB0aGlzLnVzZXJpbmZvLmdyb3VwaWQpDQogICAgICB0aGlzLiRzZXQodGhpcy5jbG9ja0RhdGEsICdncm91cE5hbWUnLCB0aGlzLnVzZXJpbmZvLmdyb3VwbmFtZSkNCiAgICAgIHRoaXMuJHNldCh0aGlzLmNsb2NrRGF0YSwgJ3Byb2plY3RJZCcsIHRoaXMuY3VycmVudEJpYW9EdWFuLmlkKQ0KICAgICAgdGhpcy4kc2V0KHRoaXMuY2xvY2tEYXRhLCAncHJvamVjdE5hbWUnLCB0aGlzLmN1cnJlbnRCaWFvRHVhbi5uYW1lKQ0KICAgICAgdGhpcy5nZXRMb2NhdGlvbigpDQogICAgICB0aGlzLmdldEZlbmNlKCkNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRMb2NhdGlvbigpIHsNCiAgICAgIGxvY2F0aW9uVXRpbC5nZXRDdXJyZW50TG9jYXRpb24oKS50aGVuKGxvY2F0aW9uID0+IHsNCiAgICAgICAgaWYgKCFsb2NhdGlvbikgew0KICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICAgIHRoaXMuJHNldCh0aGlzLmNsb2NrRGF0YSwgJ2Nsb2NrQWRkcicsIGxvY2F0aW9uPy5hZGRyZXNzKQ0KICAgICAgICB0aGlzLiRzZXQodGhpcy5jbG9ja0RhdGEsICdjbG9ja0Nvb3JkaW5hdGUnLCBgJHtsb2NhdGlvbj8ubG9ufSwke2xvY2F0aW9uPy5sYXR9YCkNCiAgICAgICAgaWYgKHRoaXMubGFzdExvY2F0aW9uTWFya2VyKSB7DQogICAgICAgICAgbGVhZkxldE1hcC5yZW1vdmVMYXllcih0aGlzLmxhc3RMb2NhdGlvbk1hcmtlcikNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmxhc3RMb2NhdGlvbk1hcmtlciA9IEwubWFya2VyKFtsb2NhdGlvbj8ubGF0LCBsb2NhdGlvbj8ubG9uXSkNCiAgICAgICAgbGVhZkxldE1hcC5hZGRMYXllcih0aGlzLmxhc3RMb2NhdGlvbk1hcmtlcikNCiAgICAgICAgdGhpcy4kcmVmcy5sZWFmTGV0TWFwUmVmLmdvdG9Qb2ludChsb2NhdGlvbj8ubG9uLCBsb2NhdGlvbj8ubGF0KQ0KICAgICAgICB0aGlzLmN1ckxvY2F0aW9uID0gW2xvY2F0aW9uPy5sb24sIGxvY2F0aW9uPy5sYXRdDQogICAgICB9KQ0KICAgICAgLy/mtYvor5XmiZPljaENCiAgICAgIC8vIGxldCBsb2NhdGlvbiA9IHsNCiAgICAgIC8vICAgYWRkcmVzczogJ+a1i+ivleWcsOWdgCcsDQogICAgICAvLyAgIGxvbjogMTIwLjE1ODkwNDczODQwMTY3LA0KICAgICAgLy8gICBsYXQ6IDI5LjkwMzA2MjA4NDYzOTg1Mw0KICAgICAgLy8gfQ0KICAgICAgLy8gdGhpcy4kc2V0KHRoaXMuY2xvY2tEYXRhLCAnY2xvY2tBZGRyJywgbG9jYXRpb24/LmFkZHJlc3MpDQogICAgICAvLyB0aGlzLiRzZXQodGhpcy5jbG9ja0RhdGEsICdjbG9ja0Nvb3JkaW5hdGUnLCBgJHtsb2NhdGlvbj8ubG9ufSwke2xvY2F0aW9uPy5sYXR9YCkNCiAgICAgIC8vIGlmICh0aGlzLmxhc3RMb2NhdGlvbk1hcmtlcikgew0KICAgICAgLy8gICBsZWFmTGV0TWFwLnJlbW92ZUxheWVyKHRoaXMubGFzdExvY2F0aW9uTWFya2VyKQ0KICAgICAgLy8gfQ0KICAgICAgLy8gdGhpcy5sYXN0TG9jYXRpb25NYXJrZXIgPSBMLm1hcmtlcihbbG9jYXRpb24/LmxhdCwgbG9jYXRpb24/Lmxvbl0pDQogICAgICAvLyBsZWFmTGV0TWFwLmFkZExheWVyKHRoaXMubGFzdExvY2F0aW9uTWFya2VyKQ0KICAgICAgLy8gdGhpcy4kcmVmcy5sZWFmTGV0TWFwUmVmLmdvdG9Qb2ludChsb2NhdGlvbj8ubG9uLCBsb2NhdGlvbj8ubGF0KQ0KICAgICAgLy8gdGhpcy5jdXJMb2NhdGlvbiA9IFtsb2NhdGlvbj8ubG9uLCBsb2NhdGlvbj8ubGF0XQ0KICAgIH0sDQogICAgb25TdWJtaXQodmFsdWVzKSB7DQogICAgICBsZXQgY2xvY2tGZW5jZSA9IHRoaXMuZ2V0Q2xvY2tGZW5jZSgpDQogICAgICBpZiAoIWNsb2NrRmVuY2UpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJG5vdGlmeSh7IHR5cGU6ICd3YXJuaW5nJywgbWVzc2FnZTogJ+aCqOeahOW9k+WJjeS9jee9ruS4jeWcqOaJk+WNoeWMuuWfn+WGhe+8jOaXoOazleaJk+WNoe+8gScgfSkNCiAgICAgIH0NCiAgICAgIGNvbnNvbGUubG9nKGNsb2NrRmVuY2UpDQogICAgICBsZXQgdGVtcCA9IFtdDQogICAgICB2YWx1ZXNbdGhpcy5waWNGaWxlZF0uZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbS51cmwgJiYgdGVtcC5wdXNoKGl0ZW0udXJsKQ0KICAgICAgfSkNCiAgICAgIGlmICh2YWx1ZXNbdGhpcy5waWNGaWxlZF0ubGVuZ3RoICE9PSB0ZW1wLmxlbmd0aCkgew0KICAgICAgICByZXR1cm4gdGhpcy4kbm90aWZ5KHsgdHlwZTogJ3dhcm5pbmcnLCBtZXNzYWdlOiAn6K+35LiK5Lyg54Wn54mH5oiW562J5b6F54Wn54mH5LiK5Lyg5a6M5oiQ77yBJyB9KQ0KICAgICAgfQ0KICAgICAgbGV0IGZvcm1EYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNsb2NrRGF0YSkpDQogICAgICBmb3JtRGF0YVt0aGlzLnBpY0ZpbGVkXSA9IHRlbXAuam9pbignLCcpDQogICAgICAvLyAgaWYgKCFpZmlubmVyKSB7DQogICAgICAvLyAgIHJldHVybiB0aGlzLiRub3RpZnkoeyB0eXBlOiAnd2FybmluZycsIG1lc3NhZ2U6ICfmgqjnmoTlvZPliY3kvY3nva7kuI3lnKjmiZPljaHljLrln5/lhoXvvIzml6Dms5XmiZPljaHvvIEnIH0pDQogICAgICAvLyB9DQogICAgICBmb3JtRGF0YS5naWQgPSBjbG9ja0ZlbmNlLmlkDQogICAgICBzdWJDbG9ja0luKGZvcm1EYXRhKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBnZXRDbG9ja0ZlbmNlKCkgew0KICAgICAgLy8gdGhpcy5jdXJMb2NhdGlvbiA9IFsxMjAuMTU4OTA0NzM4NDAxNjcsIDI5LjkwMzA2MjA4NDYzOTg1M10NCiAgICAgIGxldCBwdCA9IHR1cmYucG9pbnQodGhpcy5jdXJMb2NhdGlvbikNCiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLmZlbmNlcy5sZW5ndGg7IGluZGV4KyspIHsNCiAgICAgICAgbGV0IHRlbXBQb2x5Z29uID0gW10NCiAgICAgICAgbGV0IGN1clBvbHlnb25Db29yID0gSlNPTi5wYXJzZSh0aGlzLmZlbmNlc1tpbmRleF0uY29vcmRpbmF0ZSkNCiAgICAgICAgY3VyUG9seWdvbkNvb3IuZm9yRWFjaChwb2ludCA9PiB7DQogICAgICAgICAgdGVtcFBvbHlnb24ucHVzaChbcG9pbnRbMV0sIHBvaW50WzBdXSkNCiAgICAgICAgfSkNCiAgICAgICAgbGV0IHBvbHkgPSB0dXJmLnBvbHlnb24oW3RlbXBQb2x5Z29uXSkNCiAgICAgICAgbGV0IGlmaW5uZXIgPSB0dXJmLmJvb2xlYW5Qb2ludEluUG9seWdvbihwdCwgcG9seSkNCiAgICAgICAgaWYgKGlmaW5uZXIpIHsNCiAgICAgICAgICByZXR1cm4gdGhpcy5mZW5jZXNbaW5kZXhdDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiBudWxsDQogICAgfSwNCiAgICBjYW5jZWwoKSB7DQogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpDQogICAgfSwNCiAgICAvLyDnlLXlrZDlm7TmoI8NCiAgICBnZXRGZW5jZShwcmpJZCwgZmVuY2VJZCkgew0KICAgICAgbGV0IHBhcmFtID0geyBwcm9qZWN0SWQ6IHRoaXMuY3VycmVudEJpYW9EdWFuLmlkIH0NCiAgICAgIGlmICghdGhpcy5hZGQpIHsNCiAgICAgICAgcGFyYW0gPSB7IHByb2plY3RJZDogcHJqSWQgfQ0KICAgICAgICBpZiAoZmVuY2VJZCkgew0KICAgICAgICAgIHBhcmFtLmZlbmNlSWQgPSBmZW5jZUlkDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGdldEZlbmNlKHBhcmFtKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHJlcy5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgIHRoaXMuY3JlYXRlRmVuY2UoSlNPTi5wYXJzZShpdGVtLmNvb3JkaW5hdGUpKQ0KICAgICAgICB9KQ0KICAgICAgICB0aGlzLmZlbmNlcyA9IHJlcyB8fCBbXQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGNyZWF0ZUZlbmNlKGxhdGxuZ3MpIHsNCiAgICAgIHZhciBwb2x5Z29uID0gTC5wb2x5Z29uKGxhdGxuZ3MsIHsgY29sb3I6ICdncmVlbicgfSkuYWRkVG8obGVhZkxldE1hcCkNCiAgICAgIC8vIGxlYWZMZXRNYXAuZml0Qm91bmRzKHBvbHlnb24uZ2V0Qm91bmRzKCkpDQogICAgfSwNCiAgICAvLyDlnLDlm77lm57mmL4NCiAgICBtYXBFY2hvKCkgew0KICAgICAgbGV0IGxvY2F0aW9uID0gdGhpcy4kcm91dGUucGFyYW1zLmNsb2NrQ29vcmRpbmF0ZS5zcGxpdCgnLCcpDQogICAgICBMLm1hcmtlcihbbG9jYXRpb25bMV0sIGxvY2F0aW9uWzBdXSkuYWRkVG8obGVhZkxldE1hcCkNCiAgICAgIC8vIGxldCBsb2NhdGlvbkVuZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5jbG9ja0VuZENvb3JkaW5hdGUgPyB0aGlzLiRyb3V0ZS5wYXJhbXMuY2xvY2tFbmRDb29yZGluYXRlLnNwbGl0KCcsJykgOiAnJw0KICAgICAgLy8gaWYgKGxvY2F0aW9uRW5kKSB7DQogICAgICAvLyAgIEwubWFya2VyKFtsb2NhdGlvbkVuZFsxXSwgbG9jYXRpb25FbmRbMF1dKS5hZGRUbyhsZWFmTGV0TWFwKQ0KICAgICAgLy8gfQ0KICAgICAgdGhpcy4kcmVmcy5sZWFmTGV0TWFwUmVmLmdvdG9Qb2ludChsb2NhdGlvblswXSwgbG9jYXRpb25bMV0pDQogICAgICB0aGlzLmdldEZlbmNlKHRoaXMuJHJvdXRlLnBhcmFtcy5wcm9qZWN0SWQsIHRoaXMuJHJvdXRlLnBhcmFtcy5naWQpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["clockInAdd.vue"],"names":[],"mappings":";AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"clockInAdd.vue","sourceRoot":"src/views/project/contract","sourcesContent":["<template>\r\n  <div :style=\"{ height: scrollerHeight }\">\r\n    <div class=\"map\">\r\n      <leaf-let-map ref=\"leafLetMapRef\"></leaf-let-map>\r\n    </div>\r\n    <div class=\"info\">\r\n      <van-form @submit=\"onSubmit\" :v-model=\"clockData\">\r\n        <p class=\"title\">人员信息</p>\r\n        <van-cell-group inset>\r\n          <van-field v-model=\"clockData.projectName\" label=\"标段\" readonly />\r\n          <van-field v-model=\"clockData.attendancePersonName\" label=\"考勤人员\" readonly />\r\n          <van-field v-model=\"clockData.groupName\" label=\"所在部门\" readonly />\r\n          <div v-if=\"add\">\r\n            <van-field v-model=\"showTime\" label=\"日期时间\" readonly />\r\n            <van-field v-model=\"clockData.clockAddr\" label=\"打卡位置\" readonly rows=\"2\" type=\"textarea\">\r\n              <template #right-icon>\r\n                <van-icon name=\"location-o\" @click=\"getLocation\" />\r\n              </template>\r\n            </van-field>\r\n          </div>\r\n          <div v-else>\r\n            <van-field v-model=\"showTime\" label=\"打卡时间\" readonly />\r\n            <van-field v-model=\"clockData.clockAddr\" label=\"打卡位置\" readonly rows=\"2\" type=\"textarea\" />\r\n            <!-- <van-field v-model=\"showEndTime\" label=\"下班打卡时间\" readonly />\r\n            <van-field v-model=\"clockData.clockEndAddr\" label=\"下班打卡位置\" readonly rows=\"2\" type=\"textarea\" /> -->\r\n          </div>\r\n        </van-cell-group>\r\n        <p class=\"title\">签到拍照</p>\r\n        <van-cell-group inset v-if=\"add\">\r\n          <upload\r\n            label=\"上传照片\"\r\n            :name=\"picFiled\"\r\n            :rules=\"[{ required: true, message: '请选择照片' }]\"\r\n            :fileList=\"fList\"\r\n            :editable=\"add\"\r\n          ></upload>\r\n        </van-cell-group>\r\n        <van-cell-group inset v-else>\r\n          <upload\r\n            label=\"打卡照片\"\r\n            :name=\"picFiled\"\r\n            :rules=\"[{ required: true, message: '请选择照片' }]\"\r\n            :fileList=\"fList\"\r\n            :editable=\"false\"\r\n          ></upload>\r\n          <!-- <upload\r\n            label=\"下班打卡照片\"\r\n            :name=\"picFiled\"\r\n            :rules=\"[{ required: true, message: '请选择照片' }]\"\r\n            :fileList=\"fEndList\"\r\n            :editable=\"false\"\r\n          ></upload> -->\r\n        </van-cell-group>\r\n        <div class=\"btn-con\">\r\n          <!-- <van-button type=\"default\" @click=\"cancel\">取消</van-button> -->\r\n          <van-button type=\"primary\" v-if=\"add\">提交</van-button>\r\n        </div>\r\n      </van-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue'\r\nimport { mapGetters } from 'vuex'\r\nimport { getNowDate } from '@/utils/date.js'\r\nimport { locationUtil } from '@/utils/locationUtil.js'\r\nimport Upload from '@/components/common/Upload'\r\nimport LeafLetMap from '@/components/map/LeafLetMap.vue'\r\nimport { getFence, subClockIn } from '@/api/project'\r\nimport { formatImgUrl } from '@/utils/index'\r\nimport * as turf from '@turf/turf'\r\nimport { reverse_geocoding } from '@/api/bdMap.js'\r\nexport default {\r\n  components: {\r\n    Upload,\r\n    LeafLetMap\r\n  },\r\n  computed: {\r\n    ...mapGetters(['userinfo', 'currentBiaoDuan']),\r\n    scrollerHeight: function() {\r\n      return window.innerHeight - 85 + 'px'\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      picFiled: 'clockPic',\r\n      clockData: {},\r\n      showTime: '',\r\n      showEndTime: '',\r\n      curLocation: [],\r\n      curPolygonCoor: [],\r\n      fences: [],\r\n      add: true,\r\n      fList: [],\r\n      // fEndList: [],\r\n      formatImgUrl,\r\n      lastLocationMarker: null\r\n    }\r\n  },\r\n  created() {\r\n    if (JSON.stringify(this.$route.params) != '{}') {\r\n      this.fList = this.formatImgUrl(this.$route.params.clockPic)\r\n      // this.fEndList = this.formatImgUrl(this.$route.params.clockEndPic)\r\n    }\r\n  },\r\n  mounted() {\r\n    if (JSON.stringify(this.$route.params) != '{}') {\r\n      this.add = false\r\n      this.clockData = Object.assign({}, this.$route.params)\r\n      this.showTime = this.$route.params.clockTime\r\n        ? this.$route.params.clockTime.substring(0, 19).replace('T', ' ')\r\n        : ''\r\n      // this.showEndTime = this.$route.params.clockEndTime\r\n      //   ? this.$route.params.clockEndTime.substring(0, 19).replace('T', ' ')\r\n      //   : ''\r\n      this.mapEcho()\r\n    } else {\r\n      this.add = true\r\n      this.showTime = getNowDate()\r\n      let nowTime = this.moment()\r\n        .utc()\r\n        .toISOString()\r\n      this.$set(this.clockData, 'clockTime', nowTime)\r\n      this.$set(this.clockData, 'attendancePersonId', this.userinfo.id)\r\n      this.$set(this.clockData, 'attendancePersonName', this.userinfo.name)\r\n      this.$set(this.clockData, 'groupId', this.userinfo.groupid)\r\n      this.$set(this.clockData, 'groupName', this.userinfo.groupname)\r\n      this.$set(this.clockData, 'projectId', this.currentBiaoDuan.id)\r\n      this.$set(this.clockData, 'projectName', this.currentBiaoDuan.name)\r\n      this.getLocation()\r\n      this.getFence()\r\n    }\r\n  },\r\n  methods: {\r\n    getLocation() {\r\n      locationUtil.getCurrentLocation().then(location => {\r\n        if (!location) {\r\n          return\r\n        }\r\n        this.$set(this.clockData, 'clockAddr', location?.address)\r\n        this.$set(this.clockData, 'clockCoordinate', `${location?.lon},${location?.lat}`)\r\n        if (this.lastLocationMarker) {\r\n          leafLetMap.removeLayer(this.lastLocationMarker)\r\n        }\r\n        this.lastLocationMarker = L.marker([location?.lat, location?.lon])\r\n        leafLetMap.addLayer(this.lastLocationMarker)\r\n        this.$refs.leafLetMapRef.gotoPoint(location?.lon, location?.lat)\r\n        this.curLocation = [location?.lon, location?.lat]\r\n      })\r\n      //测试打卡\r\n      // let location = {\r\n      //   address: '测试地址',\r\n      //   lon: 120.15890473840167,\r\n      //   lat: 29.903062084639853\r\n      // }\r\n      // this.$set(this.clockData, 'clockAddr', location?.address)\r\n      // this.$set(this.clockData, 'clockCoordinate', `${location?.lon},${location?.lat}`)\r\n      // if (this.lastLocationMarker) {\r\n      //   leafLetMap.removeLayer(this.lastLocationMarker)\r\n      // }\r\n      // this.lastLocationMarker = L.marker([location?.lat, location?.lon])\r\n      // leafLetMap.addLayer(this.lastLocationMarker)\r\n      // this.$refs.leafLetMapRef.gotoPoint(location?.lon, location?.lat)\r\n      // this.curLocation = [location?.lon, location?.lat]\r\n    },\r\n    onSubmit(values) {\r\n      let clockFence = this.getClockFence()\r\n      if (!clockFence) {\r\n        return this.$notify({ type: 'warning', message: '您的当前位置不在打卡区域内，无法打卡！' })\r\n      }\r\n      console.log(clockFence)\r\n      let temp = []\r\n      values[this.picFiled].forEach(item => {\r\n        item.url && temp.push(item.url)\r\n      })\r\n      if (values[this.picFiled].length !== temp.length) {\r\n        return this.$notify({ type: 'warning', message: '请上传照片或等待照片上传完成！' })\r\n      }\r\n      let formData = JSON.parse(JSON.stringify(this.clockData))\r\n      formData[this.picFiled] = temp.join(',')\r\n      //  if (!ifinner) {\r\n      //   return this.$notify({ type: 'warning', message: '您的当前位置不在打卡区域内，无法打卡！' })\r\n      // }\r\n      formData.gid = clockFence.id\r\n      subClockIn(formData).then(res => {\r\n        this.$router.go(-1)\r\n      })\r\n    },\r\n    getClockFence() {\r\n      // this.curLocation = [120.15890473840167, 29.903062084639853]\r\n      let pt = turf.point(this.curLocation)\r\n      for (let index = 0; index < this.fences.length; index++) {\r\n        let tempPolygon = []\r\n        let curPolygonCoor = JSON.parse(this.fences[index].coordinate)\r\n        curPolygonCoor.forEach(point => {\r\n          tempPolygon.push([point[1], point[0]])\r\n        })\r\n        let poly = turf.polygon([tempPolygon])\r\n        let ifinner = turf.booleanPointInPolygon(pt, poly)\r\n        if (ifinner) {\r\n          return this.fences[index]\r\n        }\r\n      }\r\n      return null\r\n    },\r\n    cancel() {\r\n      this.$router.go(-1)\r\n    },\r\n    // 电子围栏\r\n    getFence(prjId, fenceId) {\r\n      let param = { projectId: this.currentBiaoDuan.id }\r\n      if (!this.add) {\r\n        param = { projectId: prjId }\r\n        if (fenceId) {\r\n          param.fenceId = fenceId\r\n        }\r\n      }\r\n      getFence(param).then(res => {\r\n        res.forEach(item => {\r\n          this.createFence(JSON.parse(item.coordinate))\r\n        })\r\n        this.fences = res || []\r\n      })\r\n    },\r\n    createFence(latlngs) {\r\n      var polygon = L.polygon(latlngs, { color: 'green' }).addTo(leafLetMap)\r\n      // leafLetMap.fitBounds(polygon.getBounds())\r\n    },\r\n    // 地图回显\r\n    mapEcho() {\r\n      let location = this.$route.params.clockCoordinate.split(',')\r\n      L.marker([location[1], location[0]]).addTo(leafLetMap)\r\n      // let locationEnd = this.$route.params.clockEndCoordinate ? this.$route.params.clockEndCoordinate.split(',') : ''\r\n      // if (locationEnd) {\r\n      //   L.marker([locationEnd[1], locationEnd[0]]).addTo(leafLetMap)\r\n      // }\r\n      this.$refs.leafLetMapRef.gotoPoint(location[0], location[1])\r\n      this.getFence(this.$route.params.projectId, this.$route.params.gid)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map {\r\n  height: 210px;\r\n  background-color: #ddd;\r\n}\r\n.info {\r\n  height: calc(100% - 210px);\r\n  overflow: auto;\r\n  p.title {\r\n    font-size: 14px;\r\n    padding-left: 15px;\r\n  }\r\n  .btn-con {\r\n    text-align: center;\r\n    display: flex;\r\n    justify-content: space-around;\r\n    padding: 10px 30px;\r\n    .van-button--normal {\r\n      padding: 0px 45px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}