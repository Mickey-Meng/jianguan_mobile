{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\head\\CenterHead.vue?vue&type=style&index=0&id=18ed6fa4&lang=scss&scoped=true&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\head\\CenterHead.vue","mtime":1684246187882},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1684411443176},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1684411446724},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1684411443221},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1684411446938},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYXBwLWhlYWQgew0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIC5pbWcgew0KICAgIGhlaWdodDogNTBweDsNCiAgICB3aWR0aDogNTBweDsNCiAgICBtYXJnaW46IDEycHggNXB4IDAgNXB4Ow0KICAgIGZsb2F0OiBsZWZ0Ow0KICB9DQogIC51c2VyLW5hbWUgew0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgfQ0KICAucHJvamVjdC1uYW1lIHsNCiAgICBmb250LXNpemU6IDE1cHg7DQogICAgbGluZS1oZWlnaHQ6IGluaXRpYWw7DQogIH0NCiAgLnByb2plY3QtbmFtZTo6YWZ0ZXIgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB0b3A6IDUwJTsNCiAgICByaWdodDogLTIwcHg7DQogICAgbWFyZ2luLXRvcDogLTdweDsNCiAgICBib3JkZXI6IDVweCBzb2xpZDsNCiAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50ICNkY2RlZTAgI2RjZGVlMDsNCiAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7DQogICAgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTsNCiAgICBvcGFjaXR5OiAwLjg7DQogICAgY29udGVudDogJyc7DQogIH0NCiAgLm1lc3NhZ2Ugew0KICAgIGZsb2F0OiByaWdodDsNCiAgICB3aWR0aDogODBweDsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIC5tZXNzYWdlLWltZyB7DQogICAgICBoZWlnaHQ6IDQycHg7DQogICAgfQ0KICB9DQogIC5zaGVldC1uYW1lIHsNCiAgICBwYWRkaW5nOiAxcHggMTZweDsNCiAgfQ0KfQ0K"},{"version":3,"sources":["CenterHead.vue"],"names":[],"mappings":";AAqMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CenterHead.vue","sourceRoot":"src/components/head","sourcesContent":["<template>\r\n  <div class=\"app-head\">\r\n    <van-image @click=\"goToSystem\" class=\"img\" round :src=\"headImg\" />\r\n    <span @click=\"goToSystem\" class=\"user-name\">{{ userinfo.name }}</span>\r\n    <span class=\"center-both project-name\" @click=\"show = true\">{{ project.name }}</span>\r\n    <div v-if=\"showMessageIcon && messageTotal > 0\" class=\"message\" @click=\"onMessageIconClick\">\r\n      <img class=\"message-img center-both\" :src=\"img\" />\r\n      <van-badge v-if=\"messageTotal > 0\" :content=\"messageTotal\" max=\"99\" style=\"float: right;margin: 6px 6px 0 0;\">\r\n      </van-badge>\r\n    </div>\r\n    <Weather v-else></Weather>\r\n    <van-action-sheet description=\"消息通知\" v-model=\"showMessage\" @select=\"onMessageSelect\">\r\n      <van-button\r\n        class=\"van-action-sheet__item\"\r\n        v-for=\"(item, index) in actions\"\r\n        :key=\"index\"\r\n        @click=\"onMessageSelect(item)\"\r\n      >\r\n        <van-badge :content=\"item.message === 0 ? '' : item.message\">\r\n          <span class=\"sheet-name\">{{ item.name }}</span>\r\n        </van-badge>\r\n      </van-button>\r\n    </van-action-sheet>\r\n\r\n    <van-action-sheet v-model=\"show\" :actions=\"projectList\" @select=\"onSelect\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport Weather from '@/components/weather/Weather'\r\nimport { getProject } from '@/api/project'\r\nexport default {\r\n  components: {\r\n    Weather\r\n  },\r\n  name: '',\r\n  data() {\r\n    return {\r\n      show: false,\r\n      headImg: require(`assets/image/${process.env.VUE_APP_TYPE}.png`),\r\n      projectList: [\r\n        {\r\n          name: 'G235改建'\r\n        },\r\n        {\r\n          name: '项目2'\r\n        },\r\n        {\r\n          name: '项目3'\r\n        },\r\n        {\r\n          name: '项目4'\r\n        },\r\n        {\r\n          name: '项目5'\r\n        },\r\n        {\r\n          name: '项目6'\r\n        },\r\n        {\r\n          name: '项目7'\r\n        }\r\n      ],\r\n      project: {\r\n        name: 'G235改建'\r\n      },\r\n      img: require(`assets/image/message.png`),\r\n      messageTotal: 0,\r\n      showMessage: false,\r\n      actions: [],\r\n      showMessageIcon: process.env.VUE_APP_TYPE === 'project'\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'userinfo',\r\n      'currentProject',\r\n      'qualityEventCount',\r\n      'safeEventCount',\r\n      'delayQualityEventCount',\r\n      'delaySafeEventCount',\r\n      'doRectificationQualityEventCount',\r\n      'doRectificationSafeEventCount',\r\n      'processFillingCount'\r\n    ])\r\n  },\r\n  watch: {\r\n    qualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    safeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    delayQualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    delaySafeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    doRectificationQualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    doRectificationSafeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    processFillingCount: function() {\r\n      this.updateTotal()\r\n    }\r\n  },\r\n  created() {\r\n    // getProject().then(data => {\r\n    //   let temp = []\r\n    //   data.forEach(item => {\r\n    //     temp.push({...item,...{name:item.projectname}})\r\n    //   })\r\n    //   this.projectList = temp\r\n    //   this.project = this.projectList[0]\r\n    // })\r\n    this.updateActions()\r\n  },\r\n  methods: {\r\n    goToSystem() {\r\n      this.$router.push({ name: 'system', params: this.currentProject })\r\n    },\r\n    onSelect(item) {\r\n      this.show = false\r\n      // this.$store.state.currentProject = item;\r\n      this.project = item\r\n    },\r\n    onMessageIconClick() {\r\n      this.messageTotal > 0 && (this.showMessage = true)\r\n    },\r\n    updateActions() {\r\n      let temp = [\r\n        {\r\n          name: '安全整改',\r\n          message: this.safeEventCount,\r\n          path: 'securityReportRecord',\r\n        },\r\n        {\r\n          name: '质量整改',\r\n          message: this.qualityEventCount,\r\n          path: 'modify',\r\n        },\r\n        {\r\n          name: '安全延期申请',\r\n          message: this.delaySafeEventCount,\r\n          path: 'securityReport',\r\n        },\r\n        {\r\n          name: '质量延期申请',\r\n          message: this.delayQualityEventCount,\r\n          path: 'check',\r\n        },\r\n        {\r\n          name: '安全整改确认',\r\n          message: this.doRectificationSafeEventCount,\r\n           path: 'securityDealRecord',\r\n        },\r\n        {\r\n          name: '质量整改确认',\r\n          message: this.doRectificationQualityEventCount,\r\n          path: 'verify',\r\n        },\r\n        {\r\n          name: '工序审核',\r\n          message: this.processFillingCount,\r\n          path: 'processAudit',\r\n        }\r\n      ]\r\n\r\n      this.actions = []\r\n      temp.forEach(item => {\r\n        item.message > 0 && this.actions.push(item)\r\n      })\r\n    },\r\n    updateTotal() {\r\n      this.messageTotal =\r\n        this.qualityEventCount +\r\n        this.safeEventCount +\r\n        this.delayQualityEventCount +\r\n        this.delaySafeEventCount +\r\n        this.doRectificationQualityEventCount +\r\n        this.doRectificationSafeEventCount +\r\n        this.processFillingCount\r\n\r\n      this.updateActions()\r\n    },\r\n    onMessageSelect(item) {\r\n      this.showMessage = false\r\n      this.$router.push({ path: item.path })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.app-head {\r\n  position: relative;\r\n  .img {\r\n    height: 50px;\r\n    width: 50px;\r\n    margin: 12px 5px 0 5px;\r\n    float: left;\r\n  }\r\n  .user-name {\r\n    font-size: 14px;\r\n  }\r\n  .project-name {\r\n    font-size: 15px;\r\n    line-height: initial;\r\n  }\r\n  .project-name::after {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: -20px;\r\n    margin-top: -7px;\r\n    border: 5px solid;\r\n    border-color: transparent transparent #dcdee0 #dcdee0;\r\n    -webkit-transform: rotate(-45deg);\r\n    transform: rotate(-45deg);\r\n    opacity: 0.8;\r\n    content: '';\r\n  }\r\n  .message {\r\n    float: right;\r\n    width: 80px;\r\n    height: 100%;\r\n    position: relative;\r\n    .message-img {\r\n      height: 42px;\r\n    }\r\n  }\r\n  .sheet-name {\r\n    padding: 1px 16px;\r\n  }\r\n}\r\n</style>\r\n"]}]}