{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\task\\agencytask.vue?vue&type=style&index=0&id=1ddfb4aa&scoped=true&lang=scss&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\views\\task\\agencytask.vue","mtime":1684246188054},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":1684411443176},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1684411446724},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":1684411443221},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1684411446938},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQovLyBAaW1wb3J0ICIuLi8uLi9hc3NldHMvY3NzL3RhYmxlLnNjc3MiDQouY29udGFpbmVyLWJveCB7DQogIGNvbG9yOiAjMDAwMDAwOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmFmYWZhOw0KICBoZWlnaHQ6IDEwMCU7DQogIHdpZHRoOiBjYWxjKDEwMCUgKyAxcHgpOw0KICBvdmVyZmxvdy15OiBhdXRvOw0KICAubGlzdCB7DQogICAgLml0ZW0gew0KICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgIG1hcmdpbjogNXB4Ow0KICAgICAgYm94LXNoYWRvdzogMHB4IDFweCAycHggMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgICB9DQogICAgLnZhbi1idXR0b24gew0KICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["agencytask.vue"],"names":[],"mappings":";AAiMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"agencytask.vue","sourceRoot":"src/views/task","sourcesContent":["<!--\r\n * @Descripttion:待办任务\r\n * @version:\r\n * @Author: WangHarry\r\n * @Date: 2022-05-09 14:12:16\r\n * @LastEditors: WangHarry\r\n * @LastEditTime: 2022-05-09 14:12:22\r\n-->\r\n<template>\r\n  <div class=\"container-box\">\r\n    <!-- <el-header>\r\n\t\t\t<div class=\"input-box\">\r\n\t\t\t\t<div class=\"input-value\">\r\n\t\t\t\t\t<el-input v-model=\"queryData.processDefinitionName\" placeholder=\"请输入流程名称\"></el-input>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\t\t\t<div class=\"input-box\">\r\n\t\t\t\t<div class=\"input-value\">\r\n\t\t\t\t\t<el-input v-model=\"queryData.processDefinitionKey\" placeholder=\"请输入流程标识\"></el-input>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"input-box\">\r\n\t\t\t\t<div class=\"input-value\">\r\n\t\t\t\t\t<el-input  v-model=\"queryData.taskName\" placeholder=\"请输入任务名称\"></el-input>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<el-button type=\"primary\" @click=\"query\">搜索</el-button>\r\n\t\t</el-header> -->\r\n    <van-list @load=\"query\" :style=\"{ height: scrollerHeight }\" v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\">\r\n      <van-swipe-cell\r\n        class=\"list\"\r\n        v-for=\"(item, index) in tableData\"\r\n        :key=\"index\"\r\n        :class=\"'item ' + (index === tableData.length - 1 ? 'last' : '')\"\r\n      >\r\n        <div class=\"item\" style=\"\" @click=\"gotoHandle(item)\">\r\n          <div class=\"block\">\r\n            <span class=\"block-name\">流程名称：</span>\r\n            <span class=\"block-value\" style=\"margin-left: unset;\">{{ item.processDefinitionName }}</span>\r\n          </div>\r\n          <div class=\"block\">\r\n            <span class=\"block-name\">当前任务：</span>\r\n            <span class=\"block-value\" style=\"margin-left: unset;\">{{ item.taskName }}</span>\r\n          </div>\r\n          <div class=\"block\">\r\n            <span class=\"block-name\">任务发起人：</span>\r\n            <span class=\"block-value\" style=\"margin-left: unset;\">{{ item.processInstanceInitiatorName }}</span>\r\n          </div>\r\n          <div class=\"block\">\r\n            <span class=\"block-name\">任务发起时间：</span>\r\n            <span class=\"block-value\" style=\"margin-left: unset;\">{{ item.processInstanceStartTime }}</span>\r\n          </div>\r\n          <!-- <div class=\"operate center-in-vertical\">\r\n\t\t\t\t\t\t\t<img v-if=\"item.checkresult === 3\" :src=\"require(`assets/image/待审核.png`)\" />\r\n\t\t\t\t\t\t\t<img v-if=\"item.checkresult === 1\" :src=\"require(`assets/image/已通过.png`)\" />\r\n\t\t\t\t\t\t\t<img v-if=\"item.checkresult === 2\" :src=\"require(`assets/image/已驳回.png`)\" />\r\n\t\t\t\t\t\t</div> -->\r\n        </div>\r\n\r\n        <!-- <template #right>\r\n          <van-button square type=\"primary\" text=\"办理\" @click=\"gotoHandle(item)\" />\r\n        </template> -->\r\n      </van-swipe-cell>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport * as api from '@/api/quality'\r\n//   import {constantRoutes} from \"@/router/router\";\r\n// const { constantRoutes } = require(`@/router/router.${process.env.VUE_APP_TYPE}`)\r\nimport { constantRouterMap } from '@/router/router.project.js'\r\nimport { setToken } from '@/utils/auth'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      loading: false,\r\n      finished: false,\r\n      queryData: {\r\n        processDefinitionName: '',\r\n        processDefinitionKey: '',\r\n        taskName: '',\r\n        taskHandleStatus: 1,\r\n        pageParam: {\r\n          pageNum: 0,\r\n          totalPage: 1,\r\n          pageSize: 10\r\n        }\r\n      },\r\n      routes: null,\r\n      detailRouters: []\r\n    }\r\n  },\r\n  created() {\r\n    this.routes = this.menus\r\n    console.log(constantRouterMap)\r\n    let detailRouter = constantRouterMap.find(e => e.name === 'handlerFlowTask')\r\n    this.detailRouters = detailRouter?.children\r\n  },\r\n  components: {},\r\n  computed: {\r\n    scrollerHeight: function () {\r\n      return window.innerHeight - 91 + 'px'\r\n    },\r\n    ...mapGetters(['menus'])\r\n  },\r\n  mounted() {\r\n    // this.query()\r\n  },\r\n  methods: {\r\n    query() {\r\n        this.queryData.pageParam.pageNum++;\r\n      api.listHandleTask(this.queryData).then(res => {\r\n        this.allData = res.data || {}\r\n        this.tableData = [...this.tableData,...this.allData.list || []]\r\n        this.queryData.pageParam.pageNum = res.data.pageNum\r\n        this.queryData.pageParam.totalPage = res.data.total\r\n        this.queryData.pageParam.pageSize = res.data.pageSize\r\n\r\n        // 加载状态结束\r\n        this.loading = false;\r\n        // 数据全部加载完成\r\n        if (this.tableData.length >= res.data.total) {\r\n          this.finished = true;\r\n        }\r\n      })\r\n    },\r\n    handleCurrentChange(page) {\r\n      this.queryData.pageNum = page\r\n      this.query()\r\n    },\r\n    gotoHandle(row) {\r\n      row['taskFormKey'] = typeof row['taskFormKey'] == 'string' ? JSON.parse(row['taskFormKey']) : row['taskFormKey']\r\n      let key = row['taskFormKey']['routerName']\r\n      let router = this.detailRouters.find(e => e.code.indexOf(key) !== -1)\r\n      let hiddenEdit = [\r\n        'sgdwhtrybs',\r\n        'jldwhtrybs',\r\n        'qzdwhtrybs',\r\n        'sgdwrybg',\r\n        'jldwrybg',\r\n        'qzdwrybg',\r\n        'sgdwryqj',\r\n        'jldwryqj',\r\n        'qzdwryqj'\r\n      ]\r\n      if (router) {\r\n        setToken('taskType', 1)\r\n        this.$router.push({\r\n          path: router.path,\r\n          query: {\r\n            taskId: row.taskId,\r\n            taskKey: row.taskKey,\r\n            businessKey: row.businessKey,\r\n            processDefinitionKey: row.processDefinitionKey,\r\n            processInstanceId: row.processInstanceId,\r\n            processDefinitionId: row.processDefinitionId,\r\n            taskName: row.taskName,\r\n            flowEntryName: row.processDefinitionName,\r\n            processInstanceInitiator: row.processInstanceInitiator,\r\n            isHiddenEdit: hiddenEdit.includes(key),\r\n            flowKey: hiddenEdit.includes(key) ? key : ''\r\n          }\r\n        })\r\n      }\r\n      // this.routes.forEach(parent => {\r\n      //   parent[\"children\"].forEach(child => {\r\n      //     if (child[\"meta\"][\"code\"] == row[\"taskFormKey\"][\"routerName\"]) {\r\n      //       this.$router.push({\r\n      //         path: child[\"path\"] + \"_detail\",\r\n      //         query: {\r\n      //           taskId: row.taskId,\r\n      //           businessKey: row.businessKey,\r\n      //           processDefinitionKey: row.processDefinitionKey,\r\n      //           processInstanceId: row.processInstanceId,\r\n      //           processDefinitionId: row.processDefinitionId,\r\n      //           taskName: row.taskName,\r\n      //           flowEntryName: row.processDefinitionName,\r\n      //           processInstanceInitiator: row.processInstanceInitiator\r\n      //         }\r\n      //       });\r\n      //     }\r\n      //   });\r\n      // });\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"scss\">\r\n// @import \"../../assets/css/table.scss\"\r\n.container-box {\r\n  color: #000000;\r\n  background-color: #fafafa;\r\n  height: 100%;\r\n  width: calc(100% + 1px);\r\n  overflow-y: auto;\r\n  .list {\r\n    .item {\r\n      padding: 10px;\r\n      border: 1px solid rgba(0, 0, 0, 0.1);\r\n      border-radius: 5px;\r\n      margin: 5px;\r\n      box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.1);\r\n    }\r\n    .van-button {\r\n      height: 100%;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}