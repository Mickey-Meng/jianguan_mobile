{"remainingRequest":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\head\\CenterHead.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\src\\components\\head\\CenterHead.vue","mtime":1684246187882},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1684411446344},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684411445150},{"path":"E:\\Workspace\\JianGuan\\jianguan_mobile\\mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":1684411444634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCcNCmltcG9ydCBXZWF0aGVyIGZyb20gJ0AvY29tcG9uZW50cy93ZWF0aGVyL1dlYXRoZXInDQppbXBvcnQgeyBnZXRQcm9qZWN0IH0gZnJvbSAnQC9hcGkvcHJvamVjdCcNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIFdlYXRoZXINCiAgfSwNCiAgbmFtZTogJycsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHNob3c6IGZhbHNlLA0KICAgICAgaGVhZEltZzogcmVxdWlyZShgYXNzZXRzL2ltYWdlLyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9UWVBFfS5wbmdgKSwNCiAgICAgIHByb2plY3RMaXN0OiBbDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAnRzIzNeaUueW7uicNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICfpobnnm64yJw0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogJ+mhueebrjMnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn6aG555uuNCcNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICfpobnnm641Jw0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogJ+mhueebrjYnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn6aG555uuNycNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgIHByb2plY3Q6IHsNCiAgICAgICAgbmFtZTogJ0cyMzXmlLnlu7onDQogICAgICB9LA0KICAgICAgaW1nOiByZXF1aXJlKGBhc3NldHMvaW1hZ2UvbWVzc2FnZS5wbmdgKSwNCiAgICAgIG1lc3NhZ2VUb3RhbDogMCwNCiAgICAgIHNob3dNZXNzYWdlOiBmYWxzZSwNCiAgICAgIGFjdGlvbnM6IFtdLA0KICAgICAgc2hvd01lc3NhZ2VJY29uOiBwcm9jZXNzLmVudi5WVUVfQVBQX1RZUEUgPT09ICdwcm9qZWN0Jw0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAuLi5tYXBHZXR0ZXJzKFsNCiAgICAgICd1c2VyaW5mbycsDQogICAgICAnY3VycmVudFByb2plY3QnLA0KICAgICAgJ3F1YWxpdHlFdmVudENvdW50JywNCiAgICAgICdzYWZlRXZlbnRDb3VudCcsDQogICAgICAnZGVsYXlRdWFsaXR5RXZlbnRDb3VudCcsDQogICAgICAnZGVsYXlTYWZlRXZlbnRDb3VudCcsDQogICAgICAnZG9SZWN0aWZpY2F0aW9uUXVhbGl0eUV2ZW50Q291bnQnLA0KICAgICAgJ2RvUmVjdGlmaWNhdGlvblNhZmVFdmVudENvdW50JywNCiAgICAgICdwcm9jZXNzRmlsbGluZ0NvdW50Jw0KICAgIF0pDQogIH0sDQogIHdhdGNoOiB7DQogICAgcXVhbGl0eUV2ZW50Q291bnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgdGhpcy51cGRhdGVUb3RhbCgpDQogICAgfSwNCiAgICBzYWZlRXZlbnRDb3VudDogZnVuY3Rpb24oKSB7DQogICAgICB0aGlzLnVwZGF0ZVRvdGFsKCkNCiAgICB9LA0KICAgIGRlbGF5UXVhbGl0eUV2ZW50Q291bnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgdGhpcy51cGRhdGVUb3RhbCgpDQogICAgfSwNCiAgICBkZWxheVNhZmVFdmVudENvdW50OiBmdW5jdGlvbigpIHsNCiAgICAgIHRoaXMudXBkYXRlVG90YWwoKQ0KICAgIH0sDQogICAgZG9SZWN0aWZpY2F0aW9uUXVhbGl0eUV2ZW50Q291bnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgdGhpcy51cGRhdGVUb3RhbCgpDQogICAgfSwNCiAgICBkb1JlY3RpZmljYXRpb25TYWZlRXZlbnRDb3VudDogZnVuY3Rpb24oKSB7DQogICAgICB0aGlzLnVwZGF0ZVRvdGFsKCkNCiAgICB9LA0KICAgIHByb2Nlc3NGaWxsaW5nQ291bnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgdGhpcy51cGRhdGVUb3RhbCgpDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIC8vIGdldFByb2plY3QoKS50aGVuKGRhdGEgPT4gew0KICAgIC8vICAgbGV0IHRlbXAgPSBbXQ0KICAgIC8vICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgIC8vICAgICB0ZW1wLnB1c2goey4uLml0ZW0sLi4ue25hbWU6aXRlbS5wcm9qZWN0bmFtZX19KQ0KICAgIC8vICAgfSkNCiAgICAvLyAgIHRoaXMucHJvamVjdExpc3QgPSB0ZW1wDQogICAgLy8gICB0aGlzLnByb2plY3QgPSB0aGlzLnByb2plY3RMaXN0WzBdDQogICAgLy8gfSkNCiAgICB0aGlzLnVwZGF0ZUFjdGlvbnMoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ29Ub1N5c3RlbSgpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogJ3N5c3RlbScsIHBhcmFtczogdGhpcy5jdXJyZW50UHJvamVjdCB9KQ0KICAgIH0sDQogICAgb25TZWxlY3QoaXRlbSkgew0KICAgICAgdGhpcy5zaG93ID0gZmFsc2UNCiAgICAgIC8vIHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRQcm9qZWN0ID0gaXRlbTsNCiAgICAgIHRoaXMucHJvamVjdCA9IGl0ZW0NCiAgICB9LA0KICAgIG9uTWVzc2FnZUljb25DbGljaygpIHsNCiAgICAgIHRoaXMubWVzc2FnZVRvdGFsID4gMCAmJiAodGhpcy5zaG93TWVzc2FnZSA9IHRydWUpDQogICAgfSwNCiAgICB1cGRhdGVBY3Rpb25zKCkgew0KICAgICAgbGV0IHRlbXAgPSBbDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn5a6J5YWo5pW05pS5JywNCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLnNhZmVFdmVudENvdW50LA0KICAgICAgICAgIHBhdGg6ICdzZWN1cml0eVJlcG9ydFJlY29yZCcsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn6LSo6YeP5pW05pS5JywNCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLnF1YWxpdHlFdmVudENvdW50LA0KICAgICAgICAgIHBhdGg6ICdtb2RpZnknLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogJ+WuieWFqOW7tuacn+eUs+ivtycsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy5kZWxheVNhZmVFdmVudENvdW50LA0KICAgICAgICAgIHBhdGg6ICdzZWN1cml0eVJlcG9ydCcsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn6LSo6YeP5bu25pyf55Sz6K+3JywNCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLmRlbGF5UXVhbGl0eUV2ZW50Q291bnQsDQogICAgICAgICAgcGF0aDogJ2NoZWNrJywNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICflronlhajmlbTmlLnnoa7orqQnLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZG9SZWN0aWZpY2F0aW9uU2FmZUV2ZW50Q291bnQsDQogICAgICAgICAgIHBhdGg6ICdzZWN1cml0eURlYWxSZWNvcmQnLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogJ+i0qOmHj+aVtOaUueehruiupCcsDQogICAgICAgICAgbWVzc2FnZTogdGhpcy5kb1JlY3RpZmljYXRpb25RdWFsaXR5RXZlbnRDb3VudCwNCiAgICAgICAgICBwYXRoOiAndmVyaWZ5JywNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICflt6Xluo/lrqHmoLgnLA0KICAgICAgICAgIG1lc3NhZ2U6IHRoaXMucHJvY2Vzc0ZpbGxpbmdDb3VudCwNCiAgICAgICAgICBwYXRoOiAncHJvY2Vzc0F1ZGl0JywNCiAgICAgICAgfQ0KICAgICAgXQ0KDQogICAgICB0aGlzLmFjdGlvbnMgPSBbXQ0KICAgICAgdGVtcC5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpdGVtLm1lc3NhZ2UgPiAwICYmIHRoaXMuYWN0aW9ucy5wdXNoKGl0ZW0pDQogICAgICB9KQ0KICAgIH0sDQogICAgdXBkYXRlVG90YWwoKSB7DQogICAgICB0aGlzLm1lc3NhZ2VUb3RhbCA9DQogICAgICAgIHRoaXMucXVhbGl0eUV2ZW50Q291bnQgKw0KICAgICAgICB0aGlzLnNhZmVFdmVudENvdW50ICsNCiAgICAgICAgdGhpcy5kZWxheVF1YWxpdHlFdmVudENvdW50ICsNCiAgICAgICAgdGhpcy5kZWxheVNhZmVFdmVudENvdW50ICsNCiAgICAgICAgdGhpcy5kb1JlY3RpZmljYXRpb25RdWFsaXR5RXZlbnRDb3VudCArDQogICAgICAgIHRoaXMuZG9SZWN0aWZpY2F0aW9uU2FmZUV2ZW50Q291bnQgKw0KICAgICAgICB0aGlzLnByb2Nlc3NGaWxsaW5nQ291bnQNCg0KICAgICAgdGhpcy51cGRhdGVBY3Rpb25zKCkNCiAgICB9LA0KICAgIG9uTWVzc2FnZVNlbGVjdChpdGVtKSB7DQogICAgICB0aGlzLnNob3dNZXNzYWdlID0gZmFsc2UNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogaXRlbS5wYXRoIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["CenterHead.vue"],"names":[],"mappings":";AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CenterHead.vue","sourceRoot":"src/components/head","sourcesContent":["<template>\r\n  <div class=\"app-head\">\r\n    <van-image @click=\"goToSystem\" class=\"img\" round :src=\"headImg\" />\r\n    <span @click=\"goToSystem\" class=\"user-name\">{{ userinfo.name }}</span>\r\n    <span class=\"center-both project-name\" @click=\"show = true\">{{ project.name }}</span>\r\n    <div v-if=\"showMessageIcon && messageTotal > 0\" class=\"message\" @click=\"onMessageIconClick\">\r\n      <img class=\"message-img center-both\" :src=\"img\" />\r\n      <van-badge v-if=\"messageTotal > 0\" :content=\"messageTotal\" max=\"99\" style=\"float: right;margin: 6px 6px 0 0;\">\r\n      </van-badge>\r\n    </div>\r\n    <Weather v-else></Weather>\r\n    <van-action-sheet description=\"消息通知\" v-model=\"showMessage\" @select=\"onMessageSelect\">\r\n      <van-button\r\n        class=\"van-action-sheet__item\"\r\n        v-for=\"(item, index) in actions\"\r\n        :key=\"index\"\r\n        @click=\"onMessageSelect(item)\"\r\n      >\r\n        <van-badge :content=\"item.message === 0 ? '' : item.message\">\r\n          <span class=\"sheet-name\">{{ item.name }}</span>\r\n        </van-badge>\r\n      </van-button>\r\n    </van-action-sheet>\r\n\r\n    <van-action-sheet v-model=\"show\" :actions=\"projectList\" @select=\"onSelect\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport Weather from '@/components/weather/Weather'\r\nimport { getProject } from '@/api/project'\r\nexport default {\r\n  components: {\r\n    Weather\r\n  },\r\n  name: '',\r\n  data() {\r\n    return {\r\n      show: false,\r\n      headImg: require(`assets/image/${process.env.VUE_APP_TYPE}.png`),\r\n      projectList: [\r\n        {\r\n          name: 'G235改建'\r\n        },\r\n        {\r\n          name: '项目2'\r\n        },\r\n        {\r\n          name: '项目3'\r\n        },\r\n        {\r\n          name: '项目4'\r\n        },\r\n        {\r\n          name: '项目5'\r\n        },\r\n        {\r\n          name: '项目6'\r\n        },\r\n        {\r\n          name: '项目7'\r\n        }\r\n      ],\r\n      project: {\r\n        name: 'G235改建'\r\n      },\r\n      img: require(`assets/image/message.png`),\r\n      messageTotal: 0,\r\n      showMessage: false,\r\n      actions: [],\r\n      showMessageIcon: process.env.VUE_APP_TYPE === 'project'\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'userinfo',\r\n      'currentProject',\r\n      'qualityEventCount',\r\n      'safeEventCount',\r\n      'delayQualityEventCount',\r\n      'delaySafeEventCount',\r\n      'doRectificationQualityEventCount',\r\n      'doRectificationSafeEventCount',\r\n      'processFillingCount'\r\n    ])\r\n  },\r\n  watch: {\r\n    qualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    safeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    delayQualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    delaySafeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    doRectificationQualityEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    doRectificationSafeEventCount: function() {\r\n      this.updateTotal()\r\n    },\r\n    processFillingCount: function() {\r\n      this.updateTotal()\r\n    }\r\n  },\r\n  created() {\r\n    // getProject().then(data => {\r\n    //   let temp = []\r\n    //   data.forEach(item => {\r\n    //     temp.push({...item,...{name:item.projectname}})\r\n    //   })\r\n    //   this.projectList = temp\r\n    //   this.project = this.projectList[0]\r\n    // })\r\n    this.updateActions()\r\n  },\r\n  methods: {\r\n    goToSystem() {\r\n      this.$router.push({ name: 'system', params: this.currentProject })\r\n    },\r\n    onSelect(item) {\r\n      this.show = false\r\n      // this.$store.state.currentProject = item;\r\n      this.project = item\r\n    },\r\n    onMessageIconClick() {\r\n      this.messageTotal > 0 && (this.showMessage = true)\r\n    },\r\n    updateActions() {\r\n      let temp = [\r\n        {\r\n          name: '安全整改',\r\n          message: this.safeEventCount,\r\n          path: 'securityReportRecord',\r\n        },\r\n        {\r\n          name: '质量整改',\r\n          message: this.qualityEventCount,\r\n          path: 'modify',\r\n        },\r\n        {\r\n          name: '安全延期申请',\r\n          message: this.delaySafeEventCount,\r\n          path: 'securityReport',\r\n        },\r\n        {\r\n          name: '质量延期申请',\r\n          message: this.delayQualityEventCount,\r\n          path: 'check',\r\n        },\r\n        {\r\n          name: '安全整改确认',\r\n          message: this.doRectificationSafeEventCount,\r\n           path: 'securityDealRecord',\r\n        },\r\n        {\r\n          name: '质量整改确认',\r\n          message: this.doRectificationQualityEventCount,\r\n          path: 'verify',\r\n        },\r\n        {\r\n          name: '工序审核',\r\n          message: this.processFillingCount,\r\n          path: 'processAudit',\r\n        }\r\n      ]\r\n\r\n      this.actions = []\r\n      temp.forEach(item => {\r\n        item.message > 0 && this.actions.push(item)\r\n      })\r\n    },\r\n    updateTotal() {\r\n      this.messageTotal =\r\n        this.qualityEventCount +\r\n        this.safeEventCount +\r\n        this.delayQualityEventCount +\r\n        this.delaySafeEventCount +\r\n        this.doRectificationQualityEventCount +\r\n        this.doRectificationSafeEventCount +\r\n        this.processFillingCount\r\n\r\n      this.updateActions()\r\n    },\r\n    onMessageSelect(item) {\r\n      this.showMessage = false\r\n      this.$router.push({ path: item.path })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.app-head {\r\n  position: relative;\r\n  .img {\r\n    height: 50px;\r\n    width: 50px;\r\n    margin: 12px 5px 0 5px;\r\n    float: left;\r\n  }\r\n  .user-name {\r\n    font-size: 14px;\r\n  }\r\n  .project-name {\r\n    font-size: 15px;\r\n    line-height: initial;\r\n  }\r\n  .project-name::after {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: -20px;\r\n    margin-top: -7px;\r\n    border: 5px solid;\r\n    border-color: transparent transparent #dcdee0 #dcdee0;\r\n    -webkit-transform: rotate(-45deg);\r\n    transform: rotate(-45deg);\r\n    opacity: 0.8;\r\n    content: '';\r\n  }\r\n  .message {\r\n    float: right;\r\n    width: 80px;\r\n    height: 100%;\r\n    position: relative;\r\n    .message-img {\r\n      height: 42px;\r\n    }\r\n  }\r\n  .sheet-name {\r\n    padding: 1px 16px;\r\n  }\r\n}\r\n</style>\r\n"]}]}