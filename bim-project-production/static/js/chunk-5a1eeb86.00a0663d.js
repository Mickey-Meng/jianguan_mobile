(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a1eeb86"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f"),a("00b4");var i=a("6b75");function n(t,e){if(t){if("string"===typeof t)return Object(i["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(i["a"])(t,e):void 0}}},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var i=a("6b75");function n(t){if(Array.isArray(t))return Object(i["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var l=a("06c5");a("d9e2");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t){return n(t)||r(t)||Object(l["a"])(t)||c()}},3970:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-content"},[e("el-form",{ref:"form",attrs:{"label-width":"80px"}},[e("div",{staticClass:"form-block"},[e("div",{staticClass:"form-block-title"},[e("div",{staticClass:"title-bar"}),e("strong",[t._v("基本信息")])]),e("projectinfo"),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("合同编号")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.formData.contractCode)+" ")])])]),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("承包人")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.formData.contractUser)+" ")])])])],1),e("div",{staticClass:"form-block"},[e("div",{staticClass:"form-block-title"},[e("div",{staticClass:"title-bar"}),e("strong",[t._v("附件上传")])]),e("attachlist",{ref:"attachlist",attrs:{editAble:!1,attachTable:t.attachTable}})],1),e("div",{staticClass:"form-block"},[e("div",{staticClass:"form-block-title"},[e("div",{staticClass:"title-bar"}),e("strong",[t._v("合同信息")])]),e("div",{staticClass:"block-table"},[e("el-table",{staticClass:"have_scrolling",staticStyle:{width:"100%"},attrs:{data:t.contractTable,border:""}},[e("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),e("el-table-column",{attrs:{prop:"buildProjectName",align:"center",label:"拟分包工程名称","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"buildProjectPartName",width:"180px",align:"center",label:"拟分包工程部位"}}),e("el-table-column",{attrs:{prop:"contractUserName",width:"120px",align:"center",label:"承包人名称"}}),e("el-table-column",{attrs:{prop:"contractChargeUserName",width:"120px",align:"center",label:"承包负责人"}}),e("el-table-column",{attrs:{prop:"cardNum",width:"120px",align:"center",label:"身份证号"}}),e("el-table-column",{attrs:{prop:"contractNum",width:"120px",align:"center",label:"拟分包工程合同金额(元)"}}),e("el-table-column",{attrs:{prop:"buildDate",width:"120px",align:"center",label:"拟分包施工日期"}}),e("el-table-column",{attrs:{prop:"contractUserQualification",width:"120px",align:"center",label:"承包人专业分包资质"}}),e("el-table-column",{attrs:{prop:"remark",width:"120px",align:"center",label:"备注"}})],1)],1)])])],1)},n=[],r=a("ade3"),l=a("015e"),c=a("7038"),o=a("aba5"),s={data:function(){var t;return{dialogTitle:"项目全生命周期数字管理平台",dialogFormVisible:!1,baseInfo:{buildSection:1,buildSectionName:"235国道项目部",contractCode:"",buildCompany:"",supervisionUnit:""},formData:(t={attachment:[],buildSection:"4",contractCode:"",contractInfo:[],contractUser:"",deletedFlag:1,draftFlag:1},Object(r["a"])(t,"buildSection",this.$store.getters.currentBiaoDuan.id||3),Object(r["a"])(t,"projectId",this.$store.getters.curProject.id||2),Object(r["a"])(t,"projectName",""),t),attachTable:[],contractTable:[]}},created:function(){},components:{attachlist:c["a"],projectinfo:o["a"]},computed:{},watch:{},mounted:function(){},methods:{getDetail:function(t){var e=this;l["J"](t).then((function(t){var a=t["data"]||{};e.formData=a,e.attachTable=a.attachment||[],e.contractTable=a.contractInfo||[]}))}}},u=s,d=(a("f327"),a("2877")),b=Object(d["a"])(u,i,n,!1,null,"48be4dd9",null);e["default"]=b.exports},"505b":function(t,e,a){},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("14d9"),a("159b"),a("dbb4");var i=a("ade3");function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},"5ac8":function(t,e,a){"use strict";a("a200")},"61c9":function(t,e,a){},"6a4e":function(t,e,a){"use strict";a("505b")},"6b75":function(t,e,a){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}a.d(e,"a",(function(){return i}))},"6be8":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"f",(function(){return c})),a.d(e,"j",(function(){return o})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"i",(function(){return b})),a.d(e,"g",(function(){return f}));var i=a("2909"),n=(a("d3b7"),a("159b"),a("14d9"),a("b0c0"),a("e9c4"),function(t,e,a){var i=[];return e=e||"desc",a=a||"code",t.forEach((function(t){i.push({label:t[e],value:t[a]})})),i}),r=function(t){var e=t?new Date(t):new Date,a=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var r=e.getHours();r=r<10?"0"+r:r;var l=e.getMinutes(),c=e.getSeconds();return l=l<10?"0"+l:l,c=c<10?"0"+c:c,a+"-"+i+"-"+n+"  "+r+":"+l+":"+c},l=function(t,e){e=e||0;var a=t?new Date(t):new Date;a=new Date(a.setDate(a.getDate()+e));var i=a.getFullYear(),n=a.getMonth()+1;n=n<10?"0"+n:n;var r=a.getDate();r=r<10?"0"+r:r;var l=a.getHours();l=l<10?"0"+l:l;var c=a.getMinutes(),o=a.getSeconds();return c=c<10?"0"+c:c,o=o<10?"0"+o:o,i+"-"+n+"-"+r},c=function(t){var e=t?new Date(t):new Date,a=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var r=e.getHours();r=r<10?"0"+r:r;var l=e.getMinutes(),c=e.getSeconds();return l=l<10?"0"+l:l,c=c<10?"0"+c:c,a+"-"+i},o=function(){var t=window.location.hash.split("?")[1],e={};if(t)for(var a=t.split("&"),i=0;i<a.length;i++){var n=a[i].split("=");e[n[0]]=decodeURIComponent(n[1])}return e},s=function(t){var e="",a="";return t.forEach((function(t){"sgdw"==t["typecode"]&&(e+=t["name"]+"、"),"jldw"==t["typecode"]&&(a+=t["name"]+"、")})),{buildCompany:e,supervisionUnit:a}},u=function(t,e,a){var i=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(e));a=a||[],i[0]&&a.forEach((function(t){delete i[0][t]})),n[0]&&a.forEach((function(t){delete n[0][t]}));var r=JSON.stringify(i)===JSON.stringify(n);return r},d=function(t,e){if(!t||!e)return"";var a=Date.parse(t),i=Date.parse(e);return a>i?0:a===i?1:parseInt((i-a)/864e5)},b=function(t,e){t=t||[];var a="";return t.forEach((function(t){t["value"]==e&&(a=t["label"])})),a},f=function t(e,a,n){n||(n=[]);for(var r=0;r<e.length;r++){var l=Object(i["a"])(n);if(l.push(e[r].name),e[r].id===a)return l;if(e[r].child){var c=t(e[r].child,a,l);if(c)return c}}}},7038:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[t.editAble?e("div",{staticClass:"block-line"},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",limit:1,"show-file-list":!1,accept:t.accept,"http-request":t.importFile}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1):t._e(),e("div",{staticClass:"block-table",staticStyle:{background:"rgba(0,0,0,0)"}},[e("el-table",{staticClass:"have_scrolling",staticStyle:{width:"100%"},attrs:{data:t.attachTable,border:""}},[e("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),e("el-table-column",{attrs:{prop:"fileName",align:"center",label:"附件","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"uploadTime",width:"160px",align:"center",label:"上传日期"}}),e("el-table-column",{attrs:{prop:"creatorName",width:"120px",align:"center",label:"上传人"}}),e("el-table-column",{attrs:{width:"120",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row,n=a.$index;return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.reviewAttach(i,n)}}},[t._v("预览")]),t.editAble?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.deleteAttach(i,n)}}},[t._v("删除")]):t._e()]}}])})],1)],1),e("PdfPreview",{directives:[{name:"show",rawName:"v-show",value:"pdf"==t.viewFileType,expression:"viewFileType=='pdf'"}],ref:"pdfPreview"}),e("el-dialog",{attrs:{title:"预览",visible:t.viewFileVisible,fullscreen:!0,width:"100%",height:"100%",modal:!1},on:{"update:visible":function(e){t.viewFileVisible=e}}},[e("img",{directives:[{name:"show",rawName:"v-show",value:"img"==t.viewFileType,expression:"viewFileType=='img'"}],staticStyle:{width:"100%",height:"100%"},attrs:{src:t.viewFileUrl}}),e("video",{directives:[{name:"show",rawName:"v-show",value:"mp4"==t.viewFileType,expression:"viewFileType=='mp4'"}],staticStyle:{width:"100%",height:"100%"},attrs:{src:t.viewFileUrl,controls:""}}),e("video",{directives:[{name:"show",rawName:"v-show",value:"mov"==t.viewFileType,expression:"viewFileType=='mov'"}],staticStyle:{width:"100%",height:"100%"},attrs:{src:t.viewFileUrl,controls:""}})])],1)},n=[],r=a("5530"),l=(a("a434"),a("14d9"),a("b0c0"),a("2f62")),c=a("015e"),o=a("24d2"),s=a("ed08"),u=a("6be8"),d=a("5c96"),b=a("a79c"),f={props:["attachTable","editAble","acceptList"],components:{PdfPreview:b["a"]},data:function(){return{viewFileType:"",viewFileUrl:"",viewFileVisible:!1,accept:this.acceptList||"image/*|video/*"}},computed:Object(r["a"])({},Object(l["b"])(["userInfo","name","project","roleId","getUrl"])),methods:{downloadAttach:function(t,e){c["downloadFile"]({fileid:t["fileId"]})},reviewAttach:function(t,e){var a=this,i="";(t.fileName.indexOf(".png")>-1||t.fileName.indexOf(".jpg")>-1)&&(i="img"),t.fileName.indexOf(".mp4")>-1&&(i="mp4"),(t.fileName.indexOf(".mov")>-1||t.fileName.indexOf(".MOV")>-1)&&(i="mov"),t.fileName.indexOf(".pdf")>-1&&(i="pdf"),this.viewFileType=i,this.viewFileUrl=Object(s["g"])(t.fileId),"pdf"==i?setTimeout((function(){a.$refs["pdfPreview"].show_otherPDF(t.fileId)}),300):this.viewFileVisible=!0},deleteAttach:function(t,e){var a=this;d["MessageBox"].confirm("确认是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.attachTable.splice(e,1)}))},afterUp:function(t){this.attachTable.push({uploadTime:Object(u["e"])(t["uploadTime"]),fileName:t["fileName"],fileId:t["fileId"],creatorName:this.$store.state.userinfo.name})},importFile:function(t){var e=this,a=new FileReader;a.readAsDataURL(t.file),a.onload=function(a){var i=a.target["result"].split("base64,")[1];Object(o["tb"])({name:t.file.name,base64:i}).then((function(a){e.$refs.upload.clearFiles();var i=Object(u["e"])(new Date),n=t.file.name,r=a;e.afterUp({uploadTime:i,fileName:n,fileId:r})}))}}}},v=f,p=(a("5ac8"),a("2877")),m=Object(p["a"])(v,i,n,!1,null,null,null);e["a"]=m.exports},a200:function(t,e,a){},aba5:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-block"},[e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("项目名称")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.baseInfo.projectName)+" ")])])]),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("合同号")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.baseInfo.contractCode)+" ")])])]),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("施工单位")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.baseInfo.buildCompany)+" ")])])]),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("监理单位")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.baseInfo.supervisionUnit)+" ")])])]),e("div",{staticClass:"block-line"},[e("div",{staticClass:"block-item"},[e("div",{staticClass:"block-item-label"},[t._v("标段")]),e("div",{staticClass:"block-item-value"},[t._v(" "+t._s(t.baseInfo.buildSectionName)+" ")])])])])},n=[],r=a("5530"),l=(a("b0c0"),a("2f62")),c=a("24d2"),o=a("6be8"),s={props:["hasSection"],data:function(){return{baseInfo:{projectName:"",buildSectionName:"",contractCode:"",buildCompany:"",supervisionUnit:""},hasBuildSection:void 0!=this.hasSection&&this.hasSection}},computed:Object(r["a"])({},Object(l["b"])(["userInfo","name","project","roleId","getUrl","currentBiaoDuan","curProject"])),mounted:function(){this.getProjectInfoById()},methods:{getProjectInfoById:function(){var t=this;this.baseInfo.buildSectionName=this.currentBiaoDuan.name,this.baseInfo.contractCode=this.currentBiaoDuan.contractnum,c["S"]({projectid:this.curProject.id||2}).then((function(e){var a=e||{};t.baseInfo["projectName"]=a["project"]?a["project"]["name"]:"";var i=a["companys"]||[],n=Object(o["b"])(i);t.baseInfo["buildCompany"]=n["buildCompany"],t.baseInfo["supervisionUnit"]=n["supervisionUnit"]}))}}},u=s,d=(a("6a4e"),a("2877")),b=Object(d["a"])(u,i,n,!1,null,"077e8938",null);e["a"]=b.exports},f327:function(t,e,a){"use strict";a("61c9")}}]);