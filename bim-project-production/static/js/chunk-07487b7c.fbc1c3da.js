(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07487b7c"],{"1a03":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n("e7e5");var o=n("d399"),r=(n("e17f"),n("2241")),a=(n("d3b7"),n("e9c4"),n("4e82"),n("b0c0"),n("99af"),n("f121")),i=n("3191"),c=n("f6d5"),s=function(e){return new Promise((function(t){Object(c["a"])({table:"ss_f_app_update",mapStr:JSON.stringify({os:e,type:"project"})}).then((function(n){if(n&&0!==n.length){var o=[];o=n.sort((function(e,t){return Date.parse(t["time"])-Date.parse(e["time"])}));var r=o[0],a=r.name,c=r.code,s=r.remark;t({version:{name:a,code:c},remark:JSON.parse(s)})}else t(i["a"].versionInfo[e]["project"])}))}))},u=function(e){var t=i["a"].versionInfo[e]["project"];return new Promise((function(n){s(e).then((function(e){e.version.code>t.version.code?n(e):n()}))}))},f=function(e){return new Promise((function(t){Object(r["a"])({title:"【".concat(e.version.name,"】版本更新"),message:e.remark,confirmButtonText:"更新",confirmButtonColor:"green",closeOnClickOverlay:!0}).then((function(e){"confirm"===e&&t()})).catch((function(e){}))}))},l=function(){u("ios").then((function(e){e&&f(e).then((function(){var e=encodeURI("https://apps.apple.com/cn/app/".concat(i["a"].name,"/").concat(i["a"].iosAppId));plus.runtime.openURL(e,(function(e){alert(JSON.stringify(e))}))}))}))},d=function(){u("android").then((function(e){if(e){var t="".concat("project").concat(e.version.name,".apk");f(e).then((function(){p(t)}))}}))},p=function(e){o["a"].loading({message:"安装包下载中，请等到1-2两分钟！",forbidClick:!0});var t="_downloads/"+e,n=plus.downloader.createDownload(a["data_zlsk"]+"/bim/"+e,{filename:t},(function(e,n){o["a"].clear(),200==n?plus.runtime.install(t,{},(function(){o["a"].success("安装成功")}),(function(){o["a"].fail("安装失败")})):o["a"].fail("下载失败")}));n.start()},m=function(){return new Promise((function(e){window.plus?e():document.addEventListener("plusready",(function(){e()}))}))},v=function(){m().then((function(){var e=plus.os.name.toLowerCase();"ios"===e?l():d()}))},b=function(){m().then((function(){var e=plus.os.name.toLowerCase(),t="ios"===e?"ios":"android";u(t).then((function(e){e?v():o["a"].success("当版本为最新版本！")}))}))},h=function(){var e=window.plus?window.plus.os.name.toLowerCase():"android";return i["a"].versionInfo["ios"===e?"ios":"android"]["project"]},y={checkUpdate:b,update:v,getCurrentVersionInfo:h}},"26b0":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sys-container"},[t("div",{staticClass:"card"},[t("div",{staticClass:"title"},[e._v(e._s(e.title))]),t("div",{staticClass:"oper"},[e._v(e._s(e.getRoleName()))])]),t("van-cell-group",{attrs:{inset:""}},[t("van-cell",{attrs:{title:"软件版本",value:e.versionInfo.name},on:{click:e.checkUpdate}}),t("van-cell",{attrs:{title:"退出登录","is-link":""},on:{click:e.logout}})],1)],1)},r=[],a=n("5530"),i=(n("d3b7"),n("159b"),n("14d9"),n("a15b"),n("1a03")),c=n("3191"),s=n("53fe"),u=n("2f62"),f={components:{CommonHead:s["a"]},data:function(){return{appUpdate:i["a"],title:c["a"].wholeName,params:this.$route.params,versionInfo:{},appType:"project"}},computed:Object(a["a"])({},Object(u["b"])(["userinfo"])),created:function(){this.versionInfo=i["a"].getCurrentVersionInfo().version},methods:{getRoleName:function(){var e,t,n=[this.userinfo.name];return null===(e=this.userinfo)||void 0===e||null===(t=e.roles)||void 0===t||t.forEach((function(e){n.push(e.NAME)})),n.join(" | ")},checkUpdate:function(){i["a"].checkUpdate()},logout:function(){var e=this;this.$dialog.confirm({message:"是否退出当前账号?"}).then((function(){localStorage.clear(),e.$store.state.userinfo={},e.$router.push({path:"/"})}))}}},l=f,d=(n("c52c"),n("2877")),p=Object(d["a"])(l,o,r,!1,null,"725f4f4a",null);t["default"]=p.exports},3191:function(e,t,n){"use strict";var o={project:"诸暨建设集团项目管理",center:"项目数据中心"},r={project:"1613264195",center:"1594315244"},a={projectTypes:[{name:"房建",value:"LM"},{name:"桥梁",value:"QL"},{name:"隧道",value:"SD"},{name:"其他",value:"other"}],wholeName:"全生命周期智慧建设管理平台",name:o["project"],iosAppId:r["project"],versionInfo:{ios:{project:{version:{name:"3.2",code:3200},remark:["新增人员位置"]},center:{version:{name:"1.7",code:1700},remark:["首页区分工程类型"]}},android:{project:{version:{name:"5.3",code:5300},remark:["新增人员位置"]},center:{version:{name:"2.8",code:2800},remark:["首页区分工程类型"]}}}};t["a"]=a},"53ca":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}},"53fe":function(e,t,n){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-head"},[e.left?t("div",{staticClass:"left-icon-container",on:{click:e.onClickLeft}},[t("van-icon",{staticClass:"center-both",attrs:{size:"40px",name:"arrow-left"}})],1):e._e(),t("span",{staticClass:"center-horizontal title"},[e._v(e._s(e.$route.query.title||e.$route.params.title||this.title))]),e.showIcon?t("div",{staticClass:"icon-container"},[t("van-icon",{attrs:{name:"plus"},on:{click:e.addClick}}),e.showSearch?t("van-icon",{attrs:{name:"filter-o"},on:{click:e.screenClick}}):e._e()],1):e._e()])},r=[],a={props:{title:{type:String},left:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!1}},created:function(){},methods:{onClickLeft:function(){this.$router.go(-1)},onClickRight:function(){},addClick:function(){this.$emit("fun")},screenClick:function(){this.$emit("screen")}}},i=a,c=(n("8349"),n("2877")),s=Object(c["a"])(i,o,r,!1,null,"09e78404",null);t["a"]=s.exports},5530:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("b64b"),n("a4d3"),n("4de4"),n("d3b7"),n("e439"),n("14d9"),n("159b"),n("dbb4");var o=n("ade3");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},8349:function(e,t,n){"use strict";n("b077")},"8a15":function(e,t,n){},a38e:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n("53ca");n("8172"),n("efec"),n("a4d3"),n("e01a"),n("d3b7"),n("d9e2"),n("a9e3");function r(e,t){if("object"!==Object(o["a"])(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Object(o["a"])(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function a(e){var t=r(e,"string");return"symbol"===Object(o["a"])(t)?t:String(t)}},ade3:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("a38e");function r(e,t,n){return t=Object(o["a"])(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},b077:function(e,t,n){},c52c:function(e,t,n){"use strict";n("8a15")},f6d5:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));n("e7e5");var o=n("d399"),r=(n("d3b7"),n("e9c4"),n("14d9"),n("99af"),n("a15b"),n("159b"),n("bc3a"),n("f121")),a=function(){return new Promise((function(e){window.plus?e():document.addEventListener("plusready",(function(){e()}))}))},i=function(e){return mui.init(),new Promise((function(t){a().then((function(){mui.init();var n=e.url,a=e.method,i=e.params,c=e.data,s=e.isUploadFile,u=e.loading,f=n;if(i&&"{}"!==JSON.stringify(i)){var l=[];for(var d in i)l.push("".concat(d,"=").concat(i[d]));n+="?".concat(l.join("&"))}var p={url:r["STSfmzj"]+encodeURI(n),type:a.toUpperCase(),headers:{"Content-Type":"application/json"},success:function(e){o["a"].clear(),200===e.status||0===e.meow?t(e.data):300===e.status?(t(e.data||[]),o["a"].fail(e.message||"无数据！")):o["a"].fail("".concat(f,": ").concat(e.message||"接口访问出错！"))},error:function(e,t,n){o["a"].clear(),o["a"].fail("".concat(f,": 请检查您的网络，或联系管理员！"))}};if(c&&(p.data=c),!s&&(null===i||void 0===i||!i.noToken)){var m=localStorage.getItem("userinfo");if(m){var v=JSON.parse(m);p.headers["token"]=v.token}}mui.ajax(p),u&&o["a"].loading({message:"加载中...",forbidClick:!0})}))}))};function c(e){return i({url:"/userauth/getUserInfo",method:"get",params:e})}function s(e,t,n){var o=[];return n&&n.forEach((function(e){o.push(e.ID)})),i({url:"/mapConfig/getMyMap?type=2,3&userid=".concat(e,"&groupId=").concat(t,"&rolesId=").concat(o.join(",")),method:"get"})}function u(e){return i({url:"/assets/easySelect",method:"get",params:e})}var f=function(e){return i({url:"/userauth/selectDicByParentKey?keyStr=".concat(e),method:"get"})}}}]);